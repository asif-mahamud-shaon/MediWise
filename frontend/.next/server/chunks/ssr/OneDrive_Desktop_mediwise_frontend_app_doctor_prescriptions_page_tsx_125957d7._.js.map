{"version":3,"sources":["turbopack:///[project]/OneDrive/Desktop/mediwise/frontend/app/doctor/prescriptions/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, useState } from 'react';\r\nimport { useAuth } from '@/context/AuthContext';\r\nimport { useNotification } from '@/context/NotificationContext';\r\nimport { useRouter, useSearchParams } from 'next/navigation';\r\nimport Link from 'next/link';\r\nimport Loading from '@/components/Loading';\r\nimport DoctorSidebar from '@/components/DoctorSidebar';\r\nimport api from '@/lib/api';\r\nimport { format, parseISO } from 'date-fns';\r\nimport { FiX, FiZap, FiCheck, FiEdit2, FiXCircle, FiFileText, FiMail, FiClipboard, FiActivity, FiBarChart2, FiAlertCircle, FiHeart, FiSave, FiEye, FiPrinter, FiPlus, FiCalendar, FiClock } from 'react-icons/fi';\r\n\r\nexport default function DoctorPrescriptionsPage() {\r\n  const { user, loading: authLoading, logout } = useAuth();\r\n  const { showNotification } = useNotification();\r\n  const router = useRouter();\r\n  const searchParams = useSearchParams();\r\n  const [prescriptions, setPrescriptions] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showCreateModal, setShowCreateModal] = useState(false);\r\n  const [problem, setProblem] = useState('');\r\n  const [loadingSuggestions, setLoadingSuggestions] = useState(false);\r\n  const [suggestions, setSuggestions] = useState<any>(null);\r\n\r\n  // Convert number to Roman numeral (lowercase)\r\n  const toRomanNumeral = (num: number): string => {\r\n    const romanNumerals = ['i', 'ii', 'iii', 'iv', 'v', 'vi', 'vii', 'viii', 'ix', 'x'];\r\n    if (num <= romanNumerals.length) {\r\n      return romanNumerals[num - 1];\r\n    }\r\n    // Fallback for numbers beyond x\r\n    return String(num);\r\n  };\r\n  const [prescriptionForm, setPrescriptionForm] = useState({\r\n    patientEmail: '',\r\n    diagnosis: '',\r\n    medicines: '',\r\n    tests: '',\r\n    rules: '',\r\n    instructions: '',\r\n    advice: '',\r\n    followUp: '',\r\n  });\r\n  const [doctorProfile, setDoctorProfile] = useState<any>(null);\r\n  const [patientInfo, setPatientInfo] = useState<any>(null);\r\n  const [loadingPatient, setLoadingPatient] = useState(false);\r\n  const [showPreviewModal, setShowPreviewModal] = useState(false);\r\n  const [showTemplateModal, setShowTemplateModal] = useState(false);\r\n  const [templateName, setTemplateName] = useState('');\r\n  const [templates, setTemplates] = useState<any[]>([]);\r\n  const [loadingTemplates, setLoadingTemplates] = useState(false);\r\n  const [editingTemplate, setEditingTemplate] = useState<any>(null);\r\n\r\n  useEffect(() => {\r\n    if (!authLoading && (!user || user.role !== 'doctor')) {\r\n      router.push('/login');\r\n    }\r\n  }, [user, authLoading, router]);\r\n\r\n  useEffect(() => {\r\n    if (user && user.role === 'doctor') {\r\n      fetchPrescriptions();\r\n      fetchDoctorProfile();\r\n      fetchTemplates();\r\n    }\r\n  }, [user]);\r\n\r\n  // Fetch patient info when email changes\r\n  useEffect(() => {\r\n    if (prescriptionForm.patientEmail && showCreateModal) {\r\n      const debounceTimer = setTimeout(() => {\r\n        fetchPatientInfo(prescriptionForm.patientEmail);\r\n      }, 500);\r\n      return () => clearTimeout(debounceTimer);\r\n    } else {\r\n      setPatientInfo(null);\r\n    }\r\n  }, [prescriptionForm.patientEmail, showCreateModal]);\r\n\r\n  // Check for patientEmail in query params and pre-fill form\r\n  useEffect(() => {\r\n    const patientEmail = searchParams.get('patientEmail');\r\n    if (patientEmail) {\r\n      setPrescriptionForm((prev) => ({\r\n        ...prev,\r\n        patientEmail: decodeURIComponent(patientEmail),\r\n      }));\r\n      setShowCreateModal(true);\r\n      // Clean up URL\r\n      router.replace('/doctor/prescriptions', { scroll: false });\r\n    }\r\n  }, [searchParams, router]);\r\n\r\n  const fetchPrescriptions = async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get('/prescriptions?limit=100');\r\n      setPrescriptions(response.data.prescriptions || []);\r\n    } catch (error) {\r\n      console.error('Error fetching prescriptions:', error);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const fetchDoctorProfile = async () => {\r\n    try {\r\n      const response = await api.get('/doctors/profile/me');\r\n      setDoctorProfile(response.data.doctor);\r\n    } catch (error) {\r\n      console.error('Error fetching doctor profile:', error);\r\n    }\r\n  };\r\n\r\n  const fetchPatientInfo = async (email: string) => {\r\n    if (!email || !email.includes('@')) {\r\n      setPatientInfo(null);\r\n      return;\r\n    }\r\n    try {\r\n      setLoadingPatient(true);\r\n      // Search for user by email using admin endpoint (doctors may have limited access)\r\n      // Fallback: try to find patient from prescriptions\r\n      let patient = null;\r\n      try {\r\n        const response = await api.get(`/admin/users?email=${encodeURIComponent(email)}&role=patient&limit=1`);\r\n        if (response.data.users && response.data.users.length > 0) {\r\n          patient = response.data.users[0];\r\n        }\r\n      } catch (adminError) {\r\n        // If admin endpoint fails, try finding from prescriptions\r\n        try {\r\n          const presResponse = await api.get(`/prescriptions?limit=100`);\r\n          const prescriptions = presResponse.data.prescriptions || [];\r\n          const foundPrescription = prescriptions.find((p: any) => p.patient?.email === email);\r\n          if (foundPrescription?.patient) {\r\n            patient = foundPrescription.patient;\r\n          }\r\n        } catch (presError) {\r\n          console.error('Error fetching patient from prescriptions:', presError);\r\n        }\r\n      }\r\n      \r\n      if (patient) {\r\n        // Calculate age\r\n        let age = '';\r\n        if (patient.dateOfBirth) {\r\n          const birthDate = new Date(patient.dateOfBirth);\r\n          const today = new Date();\r\n          let years = today.getFullYear() - birthDate.getFullYear();\r\n          const monthDiff = today.getMonth() - birthDate.getMonth();\r\n          if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {\r\n            years--;\r\n          }\r\n          age = `${years} years`;\r\n        }\r\n        setPatientInfo({\r\n          ...patient,\r\n          age,\r\n        });\r\n      } else {\r\n        setPatientInfo(null);\r\n      }\r\n    } catch (error) {\r\n      console.error('Error fetching patient info:', error);\r\n      setPatientInfo(null);\r\n    } finally {\r\n      setLoadingPatient(false);\r\n    }\r\n  };\r\n\r\n  const fetchAISuggestions = async () => {\r\n    if (!problem.trim()) {\r\n      showNotification('Please describe the patient\\'s problem first', 'error');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoadingSuggestions(true);\r\n      const response = await api.post('/prescriptions/ai-suggestions', {\r\n        problem: problem.trim(),\r\n      });\r\n      setSuggestions(response.data.suggestions);\r\n      // No success notification - suggestions will show directly\r\n    } catch (error: any) {\r\n      console.error('Error fetching AI suggestions:', error);\r\n      showNotification(error.response?.data?.message || 'Failed to generate AI suggestions', 'error');\r\n    } finally {\r\n      setLoadingSuggestions(false);\r\n    }\r\n  };\r\n\r\n  const acceptSuggestion = (field: string, value: string) => {\r\n    setPrescriptionForm((prev) => ({\r\n      ...prev,\r\n      [field]: value,\r\n    }));\r\n  };\r\n\r\n  const handleCreatePrescription = async (e?: React.FormEvent) => {\r\n    if (e) e.preventDefault();\r\n    try {\r\n      const medicinesArray = prescriptionForm.medicines\r\n        .split('\\n')\r\n        .map((m) => m.trim())\r\n        .filter((m) => m.length > 0)\r\n        .map((m) => {\r\n          const parts = m.split('-').map((p) => p.trim());\r\n          return {\r\n            name: parts[0] || m,\r\n            dosage: parts[1] || '',\r\n            frequency: parts[2] || '',\r\n          };\r\n        });\r\n\r\n      const testsArray = prescriptionForm.tests\r\n        .split('\\n')\r\n        .map((t) => t.trim())\r\n        .filter((t) => t.length > 0)\r\n        .map((t) => ({ name: t, description: '' }));\r\n\r\n      const rulesArray = prescriptionForm.rules\r\n        .split('\\n')\r\n        .map((r) => r.trim())\r\n        .filter((r) => r.length > 0)\r\n        .map((r) => ({ title: r, description: '' }));\r\n\r\n      // Combine instructions and followUp into instructions\r\n      const combinedInstructions = [\r\n        prescriptionForm.instructions,\r\n        prescriptionForm.followUp && `Follow-up:\\n${prescriptionForm.followUp}`,\r\n      ].filter(Boolean).join('\\n\\n');\r\n\r\n      // Use advice for rules if rules is empty\r\n      const finalRules = rulesArray.length > 0 ? rulesArray : \r\n        (prescriptionForm.advice ? prescriptionForm.advice.split('\\n').filter(a => a.trim()).map((a) => ({ title: a.trim(), description: '' })) : []);\r\n\r\n      await api.post('/prescriptions', {\r\n        patientEmail: prescriptionForm.patientEmail,\r\n        diagnosis: prescriptionForm.diagnosis,\r\n        medicines: medicinesArray,\r\n        tests: testsArray,\r\n        rules: finalRules,\r\n        instructions: combinedInstructions || prescriptionForm.instructions,\r\n      });\r\n\r\n      showNotification('Prescription created successfully', 'success');\r\n      setShowCreateModal(false);\r\n      setPrescriptionForm({ patientEmail: '', diagnosis: '', medicines: '', tests: '', rules: '', instructions: '', advice: '', followUp: '' });\r\n      setProblem('');\r\n      setSuggestions(null);\r\n      setEditingTemplate(null);\r\n      setTemplateName('');\r\n      fetchPrescriptions();\r\n    } catch (error: any) {\r\n      showNotification(error.response?.data?.message || 'Failed to create prescription', 'error');\r\n    }\r\n  };\r\n\r\n  const getInitials = (name: string) => {\r\n    return name\r\n      .split(' ')\r\n      .map((n) => n[0])\r\n      .join('')\r\n      .toUpperCase()\r\n      .slice(0, 2);\r\n  };\r\n\r\n  // Template functions\r\n  const fetchTemplates = async () => {\r\n    try {\r\n      setLoadingTemplates(true);\r\n      const response = await api.get('/templates');\r\n      setTemplates(response.data.templates || []);\r\n    } catch (error) {\r\n      console.error('Error fetching templates:', error);\r\n    } finally {\r\n      setLoadingTemplates(false);\r\n    }\r\n  };\r\n\r\n  const handleSaveTemplate = async () => {\r\n    try {\r\n      if (!templateName.trim()) {\r\n        showNotification('Please enter a template name', 'error');\r\n        return;\r\n      }\r\n\r\n      if (editingTemplate) {\r\n        await api.put(`/templates/${editingTemplate.id}`, {\r\n          name: templateName,\r\n          diagnosis: prescriptionForm.diagnosis,\r\n          medicines: prescriptionForm.medicines,\r\n          tests: prescriptionForm.tests,\r\n          rules: prescriptionForm.rules,\r\n          instructions: prescriptionForm.instructions,\r\n          advice: prescriptionForm.advice,\r\n          followUp: prescriptionForm.followUp,\r\n        });\r\n        showNotification('Template updated successfully', 'success');\r\n      } else {\r\n        await api.post('/templates', {\r\n          name: templateName,\r\n          diagnosis: prescriptionForm.diagnosis,\r\n          medicines: prescriptionForm.medicines,\r\n          tests: prescriptionForm.tests,\r\n          rules: prescriptionForm.rules,\r\n          instructions: prescriptionForm.instructions,\r\n          advice: prescriptionForm.advice,\r\n          followUp: prescriptionForm.followUp,\r\n        });\r\n        showNotification('Template saved successfully', 'success');\r\n      }\r\n      setShowTemplateModal(false);\r\n      setTemplateName('');\r\n      setEditingTemplate(null);\r\n      fetchTemplates();\r\n    } catch (error: any) {\r\n      showNotification(error.response?.data?.message || 'Failed to save template', 'error');\r\n    }\r\n  };\r\n\r\n  const handleLoadTemplate = (template: any) => {\r\n    setPrescriptionForm({\r\n      patientEmail: prescriptionForm.patientEmail, // Keep current patient email\r\n      diagnosis: template.diagnosis || '',\r\n      medicines: template.medicines || '',\r\n      tests: template.tests || '',\r\n      rules: template.rules || '',\r\n      instructions: template.instructions || '',\r\n      advice: template.advice || '',\r\n      followUp: template.followUp || '',\r\n    });\r\n    setShowTemplateModal(false);\r\n    setEditingTemplate(template);\r\n    setTemplateName(template.name);\r\n    showNotification('Template loaded. You can edit it now.', 'success');\r\n  };\r\n\r\n  const handleEditTemplate = (template: any) => {\r\n    setEditingTemplate(template);\r\n    setTemplateName(template.name);\r\n    setPrescriptionForm({\r\n      patientEmail: prescriptionForm.patientEmail,\r\n      diagnosis: template.diagnosis || '',\r\n      medicines: template.medicines || '',\r\n      tests: template.tests || '',\r\n      rules: template.rules || '',\r\n      instructions: template.instructions || '',\r\n      advice: template.advice || '',\r\n      followUp: template.followUp || '',\r\n    });\r\n    setShowTemplateModal(false);\r\n    setShowCreateModal(true);\r\n  };\r\n\r\n  const handleDeleteTemplate = async (templateId: string) => {\r\n    if (!confirm('Are you sure you want to delete this template?')) return;\r\n    try {\r\n      await api.delete(`/templates/${templateId}`);\r\n      showNotification('Template deleted successfully', 'success');\r\n      fetchTemplates();\r\n    } catch (error: any) {\r\n      showNotification(error.response?.data?.message || 'Failed to delete template', 'error');\r\n    }\r\n  };\r\n\r\n  // Print function with professional styling - exact same layout as form\r\n  const handlePrint = () => {\r\n    const printWindow = window.open('', '_blank');\r\n    if (!printWindow) return;\r\n\r\n    const printContent = `\r\n      <!DOCTYPE html>\r\n      <html>\r\n        <head>\r\n          <title>Prescription - ${patientInfo?.name || 'Patient'}</title>\r\n          <style>\r\n            @media print {\r\n              @page {\r\n                margin: 15mm;\r\n                size: A4;\r\n              }\r\n            }\r\n            * {\r\n              margin: 0;\r\n              padding: 0;\r\n              box-sizing: border-box;\r\n            }\r\n            body {\r\n              font-family: 'Times New Roman', serif;\r\n              font-size: 11pt;\r\n              line-height: 1.6;\r\n              color: #000;\r\n              background: #fff;\r\n              padding: 20px;\r\n              max-width: 100%;\r\n              position: relative;\r\n              overflow: hidden;\r\n            }\r\n            /* Watermark Background */\r\n            body::before {\r\n              content: 'MediWise';\r\n              position: fixed;\r\n              top: 50%;\r\n              left: 50%;\r\n              transform: translate(-50%, -50%) rotate(-45deg);\r\n              font-size: 150pt;\r\n              font-weight: bold;\r\n              color: rgba(0, 102, 102, 0.15);\r\n              z-index: 0;\r\n              pointer-events: none;\r\n              white-space: nowrap;\r\n              text-shadow: 0 0 10px rgba(0, 102, 102, 0.1);\r\n            }\r\n            .container {\r\n              position: relative;\r\n              z-index: 1;\r\n              max-width: 100%;\r\n            }\r\n            .header {\r\n              border-bottom: 3px solid #000;\r\n              padding-bottom: 15px;\r\n              margin-bottom: 15px;\r\n            }\r\n            .header-top {\r\n              display: flex;\r\n              justify-content: space-between;\r\n              align-items: flex-start;\r\n              margin-bottom: 10px;\r\n            }\r\n            .doctor-info-left {\r\n              flex: 1;\r\n            }\r\n            .logo-container {\r\n              width: 180px;\r\n              height: auto;\r\n              display: flex;\r\n              flex-direction: column;\r\n              align-items: center;\r\n              justify-content: flex-start;\r\n            }\r\n            .logo-image {\r\n              max-width: 100%;\r\n              height: auto;\r\n              object-fit: contain;\r\n            }\r\n            .doctor-name {\r\n              font-size: 22pt;\r\n              font-weight: bold;\r\n              color: #006666;\r\n              margin-bottom: 8px;\r\n            }\r\n            .doctor-name-bengali {\r\n              font-size: 20pt;\r\n              font-weight: bold;\r\n              color: #006666;\r\n              margin-bottom: 8px;\r\n            }\r\n            .doctor-details {\r\n              font-size: 10pt;\r\n              margin-bottom: 3px;\r\n            }\r\n            .doctor-details-bengali {\r\n              font-size: 10pt;\r\n              margin-bottom: 3px;\r\n              color: #333;\r\n            }\r\n            .bilingual-section {\r\n              margin-bottom: 10px;\r\n            }\r\n            .date-time {\r\n              text-align: right;\r\n              font-size: 10pt;\r\n              font-weight: bold;\r\n            }\r\n            .patient-section {\r\n              border-top: 2px solid #000;\r\n              padding-top: 12px;\r\n              margin-bottom: 15px;\r\n              display: flex;\r\n              justify-content: space-between;\r\n              align-items: flex-start;\r\n            }\r\n            .patient-info-left {\r\n              flex: 1;\r\n            }\r\n            .patient-label {\r\n              font-size: 10pt;\r\n              font-weight: bold;\r\n              margin-bottom: 3px;\r\n            }\r\n            .patient-input {\r\n              font-size: 10pt;\r\n              padding: 5px;\r\n              border: 2px solid #000;\r\n              width: 100%;\r\n              max-width: 300px;\r\n            }\r\n            .patient-info-right {\r\n              text-align: right;\r\n            }\r\n            .patient-name {\r\n              font-size: 12pt;\r\n              font-weight: bold;\r\n              margin-bottom: 3px;\r\n            }\r\n            .patient-details {\r\n              font-size: 10pt;\r\n            }\r\n            .two-column-layout {\r\n              display: grid;\r\n              grid-template-columns: 1fr 1fr;\r\n              gap: 40px;\r\n              margin-top: 15px;\r\n              position: relative;\r\n            }\r\n            .two-column-layout::before {\r\n              content: '';\r\n              position: absolute;\r\n              left: 50%;\r\n              top: 0;\r\n              bottom: 0;\r\n              width: 3px;\r\n              background-color: #0066cc;\r\n              transform: translateX(-50%);\r\n              z-index: 1;\r\n            }\r\n            .left-column, .right-column {\r\n              display: flex;\r\n              flex-direction: column;\r\n              gap: 25px;\r\n              position: relative;\r\n              z-index: 2;\r\n              background: white;\r\n            }\r\n            .section {\r\n              padding-bottom: 0;\r\n              margin-bottom: 0;\r\n            }\r\n            .section-title {\r\n              font-size: 12pt;\r\n              font-weight: bold;\r\n              margin-bottom: 8px;\r\n              display: flex;\r\n              align-items: center;\r\n              gap: 5px;\r\n            }\r\n            .section-content {\r\n              font-size: 10pt;\r\n              white-space: pre-wrap;\r\n              line-height: 1.8;\r\n              min-height: 40px;\r\n              padding: 0;\r\n              border: none;\r\n              font-family: inherit;\r\n            }\r\n            .medicines-content {\r\n              font-family: 'Courier New', monospace;\r\n              font-size: 10pt;\r\n            }\r\n            .footer {\r\n              margin-top: 40px;\r\n              border-top: 2px solid #000;\r\n              padding-top: 20px;\r\n              font-size: 10pt;\r\n              text-align: center;\r\n            }\r\n            .footer-content {\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n              gap: 20px;\r\n            }\r\n            .footer-logo {\r\n              width: 80px;\r\n              height: 80px;\r\n              border-radius: 50%;\r\n              background: linear-gradient(135deg, #006666 0%, #004d4d 100%);\r\n              display: flex;\r\n              align-items: center;\r\n              justify-content: center;\r\n              color: white;\r\n              font-weight: bold;\r\n              font-size: 14pt;\r\n              flex-shrink: 0;\r\n            }\r\n            .footer-info {\r\n              flex: 1;\r\n              line-height: 1.8;\r\n              text-align: center;\r\n            }\r\n            .footer-info bengali {\r\n              font-family: 'Noto Sans Bengali', 'Kalpurush', 'Siyam Rupali', sans-serif;\r\n            }\r\n            .company-name {\r\n              font-weight: bold;\r\n              font-size: 12pt;\r\n              margin-bottom: 8px;\r\n              color: #006666;\r\n              text-align: center;\r\n            }\r\n            .footer-text {\r\n              font-size: 9pt;\r\n              line-height: 1.6;\r\n              margin-bottom: 5px;\r\n              text-align: center;\r\n              display: flex;\r\n              justify-content: center;\r\n              align-items: center;\r\n              gap: 5px;\r\n              flex-wrap: wrap;\r\n            }\r\n            .hotline {\r\n              font-weight: bold;\r\n              color: #006666;\r\n              margin-top: 8px;\r\n              text-align: center;\r\n              display: flex;\r\n              justify-content: center;\r\n              align-items: center;\r\n              gap: 5px;\r\n              flex-wrap: wrap;\r\n            }\r\n            @media print {\r\n              body::before {\r\n                display: block;\r\n              }\r\n            }\r\n          </style>\r\n        </head>\r\n        <body>\r\n          <div class=\"container\">\r\n            <!-- Header Section -->\r\n            <div class=\"header\">\r\n              <div class=\"header-top\">\r\n                <div class=\"doctor-info-left\">\r\n                  <div class=\"doctor-name\">${(() => {\r\n                    const name = doctorProfile?.user?.name || user?.name || 'Name';\r\n                    const cleanName = name.replace(/^dr\\.?\\s*/i, '');\r\n                    return `Dr. ${cleanName}`;\r\n                  })()}</div>\r\n                  ${doctorProfile?.qualification ? `<div class=\"doctor-details\">${doctorProfile.qualification}</div>` : ''}\r\n                  ${doctorProfile?.specialization ? `<div class=\"doctor-details\">${doctorProfile.specialization}</div>` : ''}\r\n                  ${doctorProfile?.department?.name ? `<div class=\"doctor-details\">${doctorProfile.department.name}</div>` : ''}\r\n                  ${Array.isArray(doctorProfile?.previousJobs) && doctorProfile.previousJobs.length > 0 ? `\r\n                    <div class=\"doctor-details\">${doctorProfile.previousJobs.map((job: any) => \r\n                      typeof job === 'string' ? job : (job.title || job.position || job)\r\n                    ).join(', ')}</div>\r\n                  ` : ''}\r\n                </div>\r\n                <div class=\"logo-container\">\r\n                  <img src=\"/logo.png\" alt=\"MediWise Logo\" class=\"logo-image\" onerror=\"this.style.display='none';\" />\r\n                </div>\r\n              </div>\r\n              <div style=\"border-top: 2px solid #000; padding-top: 10px; margin-top: 10px; display: flex; justify-content: space-between; align-items: center;\">\r\n                <div style=\"flex: 1;\">\r\n                  ${(() => {\r\n                    const fullName = patientInfo?.name || '';\r\n                    const namePart = fullName ? `Patient: ${fullName}` : '';\r\n                    const age = patientInfo?.age ? `    Age: ${patientInfo.age}` : '';\r\n                    const weight = patientInfo?.weight ? `Weight: ${patientInfo.weight}kg` : '';\r\n                    \r\n                    return [namePart, age, weight].filter(Boolean).join(' ');\r\n                  })()}\r\n                </div>\r\n                <div class=\"date-time\">\r\n                  ${(() => {\r\n                    const date = new Date();\r\n                    const day = String(date.getDate()).padStart(2, '0');\r\n                    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n                    const month = monthNames[date.getMonth()];\r\n                    const year = date.getFullYear();\r\n                    const dateOnly = `${day} ${month}, ${year}`;\r\n                    const timeOnly = format(date, 'h:mm a');\r\n                    return `Date: ${dateOnly} Time: ${timeOnly}`;\r\n                  })()}\r\n                </div>\r\n              </div>\r\n            </div>\r\n            \r\n\r\n            <!-- Two Column Layout - Same as Form -->\r\n            <div class=\"two-column-layout\">\r\n              <!-- Left Column -->\r\n              <div class=\"left-column\">\r\n                ${prescriptionForm.diagnosis ? `\r\n                <div class=\"section\">\r\n                  <div class=\"section-title\">Diagnosis</div>\r\n                  <div class=\"section-content\">${prescriptionForm.diagnosis}</div>\r\n                </div>\r\n                ` : ''}\r\n                \r\n                ${prescriptionForm.tests ? `\r\n                <div class=\"section\">\r\n                  <div class=\"section-title\">Investigation</div>\r\n                  <div class=\"section-content\">${prescriptionForm.tests}</div>\r\n                </div>\r\n                ` : ''}\r\n\r\n                ${(prescriptionForm.followUp || prescriptionForm.instructions) ? `\r\n                <div class=\"section\">\r\n                  <div class=\"section-title\">Follow up</div>\r\n                  <div class=\"section-content\">${prescriptionForm.followUp || prescriptionForm.instructions}</div>\r\n                </div>\r\n                ` : ''}\r\n              </div>\r\n\r\n              <!-- Right Column -->\r\n              <div class=\"right-column\">\r\n                ${prescriptionForm.medicines ? `\r\n                <div class=\"section\">\r\n                  <div class=\"section-title\">Medicine</div>\r\n                  <div class=\"section-content medicines-content\">${prescriptionForm.medicines}</div>\r\n                </div>\r\n                ` : ''}\r\n\r\n                ${(prescriptionForm.advice || prescriptionForm.rules) ? `\r\n                <div class=\"section\">\r\n                  <div class=\"section-title\">Advice</div>\r\n                  <div class=\"section-content\">${prescriptionForm.advice || prescriptionForm.rules}</div>\r\n                </div>\r\n                ` : ''}\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Footer with Company Information -->\r\n            <div class=\"footer\">\r\n              <div class=\"footer-info\">\r\n                <div class=\"company-name\">MediWise</div>\r\n                <div class=\"footer-text\" style=\"font-family: 'Noto Sans Bengali', 'Kalpurush', 'Siyam Rupali', sans-serif;\">\r\n                  <span>‡¶ö‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞: ‡¶Æ‡ßá‡¶°‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶á‡¶ú ‡¶ï‡¶®‡¶∏‡¶æ‡¶≤‡¶ü‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞</span>\r\n                  <span>/</span>\r\n                  <span>Chamber: MediWise Consultation Center</span>\r\n                </div>\r\n                <div class=\"hotline\" style=\"font-family: 'Noto Sans Bengali', 'Kalpurush', 'Siyam Rupali', sans-serif;\">\r\n                  <span>‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶π‡¶ü‡¶≤‡¶æ‡¶á‡¶®</span>\r\n                  <span>/</span>\r\n                  <span>Hotline for Serial: <strong>+8809658303665</strong></span>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </body>\r\n      </html>\r\n    `;\r\n\r\n    printWindow.document.write(printContent);\r\n    printWindow.document.close();\r\n    printWindow.focus();\r\n    setTimeout(() => {\r\n      printWindow.print();\r\n    }, 250);\r\n  };\r\n\r\n  if (authLoading || loading) {\r\n    return <Loading />;\r\n  }\r\n\r\n  if (!user || user.role !== 'doctor') {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className=\"flex min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors\">\r\n      <DoctorSidebar user={user} logout={logout} />\r\n      <main className=\"ml-64 flex-1 p-8 transition-all duration-300\">\r\n        <div className=\"flex justify-between items-start mb-8\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-2\">Prescriptions</h1>\r\n            <p className=\"text-gray-600 dark:text-gray-400\">Manage patient prescriptions</p>\r\n          </div>\r\n          <div className=\"flex gap-3\">\r\n            <button\r\n              onClick={() => {\r\n                setShowTemplateModal(true);\r\n                setEditingTemplate(null);\r\n                setTemplateName('');\r\n              }}\r\n              className=\"px-4 py-2 border-2 border-teal-600 dark:border-teal-500 text-teal-600 dark:text-teal-400 rounded-lg hover:bg-teal-50 dark:hover:bg-teal-900/20 transition-colors font-medium flex items-center gap-2\"\r\n            >\r\n              <FiFileText />\r\n              Templates\r\n            </button>\r\n            <button\r\n              onClick={() => setShowCreateModal(true)}\r\n              className=\"px-6 py-2 bg-teal-600 dark:bg-teal-700 text-white rounded-lg hover:bg-teal-700 dark:hover:bg-teal-600 transition-colors font-medium\"\r\n            >\r\n              + New Prescription\r\n            </button>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\r\n          {prescriptions.map((prescription) => (\r\n            <div\r\n              key={prescription.id}\r\n              className=\"bg-white dark:bg-gray-800 rounded-xl shadow-md p-5 hover:shadow-lg transition-all border border-gray-100 dark:border-gray-700\"\r\n            >\r\n              <div className=\"flex items-start justify-between mb-4\">\r\n                <div className=\"flex-1\">\r\n                  <h3 className=\"text-lg font-semibold text-gray-800 dark:text-gray-100\">{prescription.patient?.name}</h3>\r\n                  <p className=\"text-sm text-gray-500 dark:text-gray-400\">{prescription.patient?.email}</p>\r\n                </div>\r\n              </div>\r\n              {prescription.diagnosis && (\r\n                <div className=\"mb-3\">\r\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Diagnosis:</p>\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">{prescription.diagnosis}</p>\r\n                </div>\r\n              )}\r\n              {prescription.medicines && Array.isArray(prescription.medicines) && prescription.medicines.length > 0 && (\r\n                <div className=\"mb-3\">\r\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Medicines:</p>\r\n                  <ul className=\"text-sm text-gray-600 dark:text-gray-400 list-disc list-inside\">\r\n                    {prescription.medicines.map((med: any, idx: number) => (\r\n                      <li key={idx}>{typeof med === 'string' ? med : med.name || med}</li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n              {prescription.instructions && (\r\n                <div className=\"mb-3\">\r\n                  <p className=\"text-sm font-medium text-gray-700 dark:text-gray-300 mb-1\">Instructions:</p>\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400\">{prescription.instructions}</p>\r\n                </div>\r\n              )}\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\r\n                {format(parseISO(prescription.prescriptionDate || prescription.createdAt), 'MMM dd, yyyy')}\r\n              </p>\r\n            </div>\r\n          ))}\r\n        </div>\r\n\r\n        {prescriptions.length === 0 && (\r\n          <div className=\"bg-white dark:bg-gray-800 rounded-xl shadow-md p-12 text-center border border-gray-100 dark:border-gray-700\">\r\n            <p className=\"text-gray-500 dark:text-gray-400 text-lg\">No prescriptions yet</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Create Prescription Modal - Professional Template */}\r\n        {showCreateModal && (\r\n          <div\r\n            className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4 overflow-y-auto\"\r\n            onClick={(e) => {\r\n              if (e.target === e.currentTarget) {\r\n                setShowCreateModal(false);\r\n              }\r\n            }}\r\n          >\r\n            <div className=\"bg-white dark:bg-gray-800 shadow-2xl w-full max-w-6xl my-auto flex flex-col transform transition-all animate-slideUp rounded-lg overflow-hidden\" style={{ minHeight: '85vh', maxHeight: '90vh' }}>\r\n              {/* Professional Prescription Header */}\r\n              <div className=\"p-4 sm:p-6 border-b-2 border-gray-400 dark:border-gray-500 bg-white dark:bg-gray-800 shrink-0\">\r\n                <div className=\"flex justify-between items-start\">\r\n                  {/* Doctor Info - Left Side */}\r\n                  <div className=\"flex-1\">\r\n                    <div className=\"grid grid-cols-2 gap-4\">\r\n                      {/* English Section - Left */}\r\n                      <div>\r\n                        <h2 className=\"text-3xl font-bold text-teal-600 dark:text-teal-400 mb-2\">\r\n                          {(() => {\r\n                            const name = doctorProfile?.user?.name || user?.name || 'Name';\r\n                            // Remove \"Dr.\" if already exists\r\n                            const cleanName = name.replace(/^dr\\.?\\s*/i, '');\r\n                            return `Dr. ${cleanName}`;\r\n                          })()}\r\n                        </h2>\r\n                        {doctorProfile?.qualification && (\r\n                          <p className=\"text-base text-gray-800 dark:text-gray-200 font-medium mb-1\">\r\n                            {doctorProfile.qualification}\r\n                          </p>\r\n                        )}\r\n                        {doctorProfile?.specialization && (\r\n                          <p className=\"text-sm text-gray-700 dark:text-gray-300 mb-1\">\r\n                            {doctorProfile.specialization}\r\n                          </p>\r\n                        )}\r\n                        {doctorProfile?.department?.name && (\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\r\n                            {doctorProfile.department.name}\r\n                          </p>\r\n                        )}\r\n                        {Array.isArray(doctorProfile?.previousJobs) && doctorProfile.previousJobs.length > 0 && (\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\r\n                            {doctorProfile.previousJobs.map((job: any) => \r\n                              typeof job === 'string' ? job : (job.title || job.position || job)\r\n                            ).join(', ')}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Bengali Section - Right - Full Bengali Information */}\r\n                      <div className=\"border-l border-gray-300 dark:border-gray-600 pl-4\">\r\n                        <h2 className=\"text-2xl font-bold text-teal-600 dark:text-teal-400 mb-2\">\r\n                          {(() => {\r\n                            const name = doctorProfile?.user?.name || user?.name || '‡¶®‡¶æ‡¶Æ';\r\n                            // Remove \"Dr.\" if already exists\r\n                            const cleanName = name.replace(/^dr\\.?\\s*/i, '');\r\n                            return `‡¶°‡¶æ‡¶É ${cleanName}`;\r\n                          })()}\r\n                        </h2>\r\n                        {/* Qualifications in Bengali - Must show ALL if English exists */}\r\n                        {doctorProfile?.qualification && (\r\n                          <p className=\"text-base text-gray-800 dark:text-gray-200 font-medium mb-1\">\r\n                            {doctorProfile?.qualificationBn || doctorProfile.qualification}\r\n                          </p>\r\n                        )}\r\n                        {/* Specialization in Bengali - Must show ALL if English exists */}\r\n                        {doctorProfile?.specialization && (\r\n                          <p className=\"text-sm text-gray-700 dark:text-gray-300 mb-1\">\r\n                            {doctorProfile?.specializationBn || doctorProfile.specialization}\r\n                          </p>\r\n                        )}\r\n                        {/* Department in Bengali - Must show if exists */}\r\n                        {doctorProfile?.department?.name && (\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\r\n                            {doctorProfile.department.name}\r\n                          </p>\r\n                        )}\r\n                        {/* Previous Jobs/Experience in Bengali - Must show ALL if English exists */}\r\n                        {Array.isArray(doctorProfile?.previousJobs) && doctorProfile.previousJobs.length > 0 && (\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\r\n                            {Array.isArray(doctorProfile?.previousJobsBn) && doctorProfile.previousJobsBn.length > 0\r\n                              ? doctorProfile.previousJobsBn.map((job: any) => \r\n                                  typeof job === 'string' ? job : (job.title || job.position || job)\r\n                                ).join(', ')\r\n                              : doctorProfile.previousJobs.map((job: any) => \r\n                                  typeof job === 'string' ? job : (job.title || job.position || job)\r\n                                ).join(', ')\r\n                            }\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Date & Time - Right Side */}\r\n                  <div className=\"text-right\">\r\n                    <p className=\"text-base font-semibold text-gray-800 dark:text-gray-200 mb-1\">\r\n                      Date: {format(new Date(), 'dd MMMM, yyyy')}\r\n                    </p>\r\n                    <p className=\"text-base font-semibold text-gray-800 dark:text-gray-200\">\r\n                      Time: {format(new Date(), 'h:mm a')}\r\n                    </p>\r\n                  </div>\r\n                </div>\r\n\r\n                {/* Patient Info Section */}\r\n                <div className=\"border-t-2 border-gray-400 dark:border-gray-500 pt-3 mt-4\">\r\n                  <div className=\"flex items-center justify-between\">\r\n                    <div className=\"flex-1 mr-4\">\r\n                      <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1\">\r\n                        Patient Email <span className=\"text-red-500\">*</span>\r\n                      </label>\r\n                      <input\r\n                        type=\"email\"\r\n                        value={prescriptionForm.patientEmail}\r\n                        onChange={(e) => setPrescriptionForm({ ...prescriptionForm, patientEmail: e.target.value })}\r\n                        required\r\n                        className=\"w-full max-w-sm px-3 py-1.5 border-2 border-gray-400 dark:border-gray-500 rounded focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 text-sm\"\r\n                        placeholder=\"patient@example.com\"\r\n                      />\r\n                    </div>\r\n                    {patientInfo && (\r\n                      <div className=\"text-right\">\r\n                        <p className=\"text-base font-semibold text-gray-800 dark:text-gray-200\">\r\n                          Patient: {patientInfo.name || 'N/A'}\r\n                        </p>\r\n                        {patientInfo.age && (\r\n                          <p className=\"text-sm text-gray-600 dark:text-gray-400\">\r\n                            Age: {patientInfo.age} {patientInfo.weight ? `years | Weight: ${patientInfo.weight}` : 'years'}\r\n                          </p>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                    {loadingPatient && (\r\n                      <div className=\"text-right\">\r\n                        <p className=\"text-sm text-gray-500 italic\">Loading...</p>\r\n                      </div>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Professional Prescription Body - Two Column Layout */}\r\n              <div className=\"overflow-y-auto flex-1 p-4 sm:p-6 md:p-8 bg-white dark:bg-gray-800\" style={{ maxHeight: 'calc(85vh - 250px)' }}>\r\n                <form onSubmit={handleCreatePrescription} className=\"space-y-4 sm:space-y-6\">\r\n                  {/* Problem Input & AI Suggestions Section */}\r\n                  <div className=\"mb-5 p-3 bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-300 dark:border-blue-700\">\r\n                    <label className=\"block text-sm font-bold text-gray-800 dark:text-gray-200 mb-2\">\r\n                      üìù Patient Problem / Notes\r\n                    </label>\r\n                    <textarea\r\n                      value={problem}\r\n                      onChange={(e) => setProblem(e.target.value)}\r\n                      rows={3}\r\n                      className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 text-sm resize-none\"\r\n                      placeholder=\"Describe the patient's symptoms, complaints, or medical issues here...\"\r\n                    />\r\n                    <div className=\"mt-2 flex items-center gap-2\">\r\n                      <button\r\n                        type=\"button\"\r\n                        onClick={fetchAISuggestions}\r\n                        disabled={!problem.trim() || loadingSuggestions}\r\n                        className=\"px-4 py-2 bg-linear-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 text-sm font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-md\"\r\n                      >\r\n                        <FiZap className={loadingSuggestions ? 'animate-spin' : ''} />\r\n                        {loadingSuggestions ? 'Generating...' : '‚ú® Get AI Suggestions'}\r\n                      </button>\r\n                      {suggestions && (\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => setSuggestions(null)}\r\n                          className=\"px-3 py-2 border-2 border-gray-400 dark:border-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-sm font-medium text-gray-700 dark:text-gray-300\"\r\n                        >\r\n                          Clear\r\n                        </button>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* AI Suggestions */}\r\n                  {suggestions && (\r\n                    <div className=\"mb-5 p-4 bg-linear-to-br from-purple-50 to-pink-50 dark:from-purple-900/30 dark:to-pink-900/30 border-2 border-purple-300 dark:border-purple-700\">\r\n                      <h3 className=\"font-bold text-gray-800 dark:text-gray-100 text-base mb-3 flex items-center gap-2\">\r\n                        <FiZap className=\"text-purple-600 dark:text-purple-400\" />\r\n                        AI-Powered Suggestions\r\n                      </h3>\r\n                      <div className=\"space-y-2.5 mb-3\">\r\n                        {suggestions.diagnosis && (\r\n                          <div className=\"p-2.5 bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-700\">\r\n                            <p className=\"text-xs font-bold text-gray-800 dark:text-gray-200 mb-1\">Diagnosis:</p>\r\n                            <p className=\"text-xs text-gray-700 dark:text-gray-300 leading-relaxed\">{suggestions.diagnosis}</p>\r\n                          </div>\r\n                        )}\r\n                        {suggestions.medicines && (\r\n                          <div className=\"p-2.5 bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-700\">\r\n                            <p className=\"text-xs font-bold text-gray-800 dark:text-gray-200 mb-1\">Medicines:</p>\r\n                            <div className=\"text-xs text-gray-700 dark:text-gray-300 leading-relaxed\">\r\n                              {Array.isArray(suggestions.medicines) ? (\r\n                                <ul className=\"list-none space-y-1.5\">\r\n                                  {suggestions.medicines.map((medicine: string, index: number) => (\r\n                                    <li key={index} className=\"flex items-start gap-2\">\r\n                                      <span className=\"font-semibold text-purple-600 dark:text-purple-400 shrink-0\">\r\n                                        {toRomanNumeral(index + 1)}.\r\n                                      </span>\r\n                                      <span className=\"flex-1\">{medicine}</span>\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              ) : (\r\n                                <p className=\"whitespace-pre-wrap font-mono\">{suggestions.medicines}</p>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                        {suggestions.tests && (\r\n                          <div className=\"p-2.5 bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-700\">\r\n                            <p className=\"text-xs font-bold text-gray-800 dark:text-gray-200 mb-1\">Tests:</p>\r\n                            <div className=\"text-xs text-gray-700 dark:text-gray-300 leading-relaxed\">\r\n                              {Array.isArray(suggestions.tests) ? (\r\n                                <ul className=\"list-none space-y-1.5\">\r\n                                  {suggestions.tests.map((test: string, index: number) => (\r\n                                    <li key={index} className=\"flex items-start gap-2\">\r\n                                      <span className=\"font-semibold text-purple-600 dark:text-purple-400 shrink-0\">\r\n                                        {toRomanNumeral(index + 1)}.\r\n                                      </span>\r\n                                      <span className=\"flex-1\">{test}</span>\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              ) : (\r\n                                <p className=\"whitespace-pre-wrap\">{suggestions.tests}</p>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                        {suggestions.rules && (\r\n                          <div className=\"p-2.5 bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-700\">\r\n                            <p className=\"text-xs font-bold text-gray-800 dark:text-gray-200 mb-1\">Rules:</p>\r\n                            <div className=\"text-xs text-gray-700 dark:text-gray-300 leading-relaxed\">\r\n                              {Array.isArray(suggestions.rules) ? (\r\n                                <ul className=\"list-none space-y-1.5\">\r\n                                  {suggestions.rules.map((rule: string, index: number) => (\r\n                                    <li key={index} className=\"flex items-start gap-2\">\r\n                                      <span className=\"font-semibold text-purple-600 dark:text-purple-400 shrink-0\">\r\n                                        {toRomanNumeral(index + 1)}.\r\n                                      </span>\r\n                                      <span className=\"flex-1\">{rule}</span>\r\n                                    </li>\r\n                                  ))}\r\n                                </ul>\r\n                              ) : (\r\n                                <p className=\"whitespace-pre-wrap\">{suggestions.rules}</p>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                        {suggestions.instructions && (\r\n                          <div className=\"p-2.5 bg-white dark:bg-gray-800 border-2 border-purple-200 dark:border-purple-700\">\r\n                            <p className=\"text-xs font-bold text-gray-800 dark:text-gray-200 mb-1\">Instructions:</p>\r\n                            <pre className=\"text-xs text-gray-700 dark:text-gray-300 whitespace-pre-wrap leading-relaxed\">{suggestions.instructions}</pre>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      <div className=\"flex gap-3 pt-3 border-t-2 border-purple-300 dark:border-purple-700\">\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => setSuggestions(null)}\r\n                          className=\"flex-1 px-4 py-2 border-2 border-gray-400 dark:border-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 text-sm font-semibold text-gray-700 dark:text-gray-300\"\r\n                        >\r\n                          Cancel\r\n                        </button>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => {\r\n                            if (suggestions.diagnosis) {\r\n                              setPrescriptionForm(prev => ({ ...prev, diagnosis: suggestions.diagnosis }));\r\n                            }\r\n                            if (suggestions.medicines) {\r\n                              const medicinesText = Array.isArray(suggestions.medicines) \r\n                                ? suggestions.medicines.map((med: string, idx: number) => `${toRomanNumeral(idx + 1)}. ${med}`).join('\\n')\r\n                                : suggestions.medicines;\r\n                              setPrescriptionForm(prev => ({ ...prev, medicines: medicinesText }));\r\n                            }\r\n                            if (suggestions.tests) {\r\n                              const testsText = Array.isArray(suggestions.tests)\r\n                                ? suggestions.tests.map((test: string, idx: number) => `${toRomanNumeral(idx + 1)}. ${test}`).join('\\n')\r\n                                : suggestions.tests;\r\n                              setPrescriptionForm(prev => ({ ...prev, tests: testsText }));\r\n                            }\r\n                            if (suggestions.rules) {\r\n                              const rulesText = Array.isArray(suggestions.rules)\r\n                                ? suggestions.rules.map((rule: string, idx: number) => `${toRomanNumeral(idx + 1)}. ${rule}`).join('\\n')\r\n                                : suggestions.rules;\r\n                              setPrescriptionForm(prev => ({ ...prev, rules: rulesText, advice: rulesText }));\r\n                            }\r\n                            if (suggestions.instructions) {\r\n                              setPrescriptionForm(prev => ({ ...prev, instructions: suggestions.instructions, followUp: suggestions.instructions }));\r\n                            }\r\n                            setSuggestions(null);\r\n                          }}\r\n                          className=\"flex-1 px-4 py-2 bg-linear-to-r from-green-500 to-teal-500 text-white rounded-lg hover:from-green-600 hover:to-teal-600 text-sm font-semibold shadow-md\"\r\n                        >\r\n                          <FiCheck className=\"inline mr-1\" />\r\n                          Approve & Fill\r\n                        </button>\r\n                      </div>\r\n                    </div>\r\n                  )}\r\n\r\n                  {/* Two Column Layout - Professional Prescription Style */}\r\n                  <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 md:gap-8 mt-4\">\r\n                    {/* Left Column */}\r\n                    <div className=\"space-y-5\">\r\n                      {/* Diagnosis */}\r\n                      <div className=\"border-b-2 border-gray-400 dark:border-gray-500 pb-3\">\r\n                        <label className=\"flex items-center gap-2 text-base font-bold text-gray-900 dark:text-gray-100 mb-2\">\r\n                          Diagnosis\r\n                          <FiEdit2 className=\"text-sm text-gray-500 cursor-pointer hover:text-teal-600\" />\r\n                        </label>\r\n                        <textarea\r\n                          value={prescriptionForm.diagnosis}\r\n                          onChange={(e) => setPrescriptionForm({ ...prescriptionForm, diagnosis: e.target.value })}\r\n                          rows={3}\r\n                          className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-sm bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 resize-none font-medium\"\r\n                          placeholder=\"Enter diagnosis (one per line)\"\r\n                        />\r\n                      </div>\r\n\r\n                      {/* Investigation */}\r\n                      <div className=\"border-b-2 border-gray-400 dark:border-gray-500 pb-3\">\r\n                        <label className=\"flex items-center gap-2 text-base font-bold text-gray-900 dark:text-gray-100 mb-2\">\r\n                          Investigation\r\n                          <FiEdit2 className=\"text-sm text-gray-500 cursor-pointer hover:text-teal-600\" />\r\n                        </label>\r\n                        <textarea\r\n                          value={prescriptionForm.tests}\r\n                          onChange={(e) => setPrescriptionForm({ ...prescriptionForm, tests: e.target.value })}\r\n                          rows={3}\r\n                          className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-sm bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 resize-none font-medium\"\r\n                          placeholder=\"Enter lab tests/investigations (one per line)\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n\r\n                    {/* Right Column */}\r\n                    <div className=\"space-y-5\">\r\n                      {/* Medicine */}\r\n                      <div className=\"border-b-2 border-gray-400 dark:border-gray-500 pb-3\">\r\n                        <label className=\"flex items-center gap-2 text-base font-bold text-gray-900 dark:text-gray-100 mb-2\">\r\n                          Medicine\r\n                          <FiEdit2 className=\"text-sm text-gray-500 cursor-pointer hover:text-teal-600\" />\r\n                        </label>\r\n                        <textarea\r\n                          value={prescriptionForm.medicines}\r\n                          onChange={(e) => setPrescriptionForm({ ...prescriptionForm, medicines: e.target.value })}\r\n                          rows={8}\r\n                          className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 font-mono text-sm bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 resize-none\"\r\n                          placeholder=\"Medicine Name - Dosage - Frequency&#10;Example: Paracetamol - 500mg - 2 times daily\"\r\n                        />\r\n                      </div>\r\n\r\n                      {/* Advice */}\r\n                      <div className=\"border-b-2 border-gray-400 dark:border-gray-500 pb-3\">\r\n                        <label className=\"flex items-center gap-2 text-base font-bold text-gray-900 dark:text-gray-100 mb-2\">\r\n                          Advice\r\n                          <FiPlus className=\"text-sm text-gray-500 cursor-pointer hover:text-teal-600\" />\r\n                        </label>\r\n                        <textarea\r\n                          value={prescriptionForm.advice || prescriptionForm.rules}\r\n                          onChange={(e) => {\r\n                            setPrescriptionForm({ ...prescriptionForm, advice: e.target.value, rules: e.target.value });\r\n                          }}\r\n                          rows={4}\r\n                          className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-sm bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 resize-none font-medium\"\r\n                          placeholder=\"Enter advice/guidelines (one per line)\"\r\n                        />\r\n                      </div>\r\n\r\n                      {/* Follow up */}\r\n                      <div className=\"border-b-2 border-gray-400 dark:border-gray-500 pb-3\">\r\n                        <label className=\"flex items-center gap-2 text-base font-bold text-gray-900 dark:text-gray-100 mb-2\">\r\n                          Follow up\r\n                          <FiPlus className=\"text-sm text-gray-500 cursor-pointer hover:text-teal-600\" />\r\n                        </label>\r\n                        <textarea\r\n                          value={prescriptionForm.followUp || prescriptionForm.instructions}\r\n                          onChange={(e) => {\r\n                            setPrescriptionForm({ ...prescriptionForm, followUp: e.target.value, instructions: e.target.value });\r\n                          }}\r\n                          rows={3}\r\n                          className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 focus:ring-2 focus:ring-teal-500 focus:border-teal-500 text-sm bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 resize-none font-medium\"\r\n                          placeholder=\"Enter follow-up instructions\"\r\n                        />\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n\r\n                  {/* Action Buttons */}\r\n                  <div className=\"flex flex-wrap gap-2 sm:gap-3 pt-4 sm:pt-5 border-t-2 border-gray-400 dark:border-gray-500 mt-6 sm:mt-8 shrink-0\">\r\n                    <button\r\n                      type=\"submit\"\r\n                      onClick={handleCreatePrescription}\r\n                      className=\"px-5 py-2.5 bg-teal-600 dark:bg-teal-700 text-white rounded-lg hover:bg-teal-700 dark:hover:bg-teal-600 font-bold transition-colors flex items-center gap-2 text-sm shadow-md\"\r\n                    >\r\n                      <FiCheck className=\"text-base\" />\r\n                      Save & Send\r\n                    </button>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => setShowPreviewModal(true)}\r\n                      className=\"px-5 py-2.5 border-2 border-gray-400 dark:border-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold text-gray-700 dark:text-gray-300 transition-colors flex items-center gap-2 text-sm\"\r\n                    >\r\n                      <FiEye className=\"text-base\" />\r\n                      Preview\r\n                    </button>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        if (editingTemplate) {\r\n                          // If editing, keep the template name\r\n                          setTemplateName(editingTemplate.name);\r\n                        } else {\r\n                          setTemplateName('');\r\n                          setEditingTemplate(null);\r\n                        }\r\n                        setShowTemplateModal(true);\r\n                      }}\r\n                      className=\"px-5 py-2.5 border-2 border-gray-400 dark:border-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold text-gray-700 dark:text-gray-300 transition-colors text-sm flex items-center gap-2\"\r\n                    >\r\n                      <FiSave className=\"text-base\" />\r\n                      {editingTemplate ? 'Update Template' : 'Save as Template'}\r\n                    </button>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={handlePrint}\r\n                      className=\"px-5 py-2.5 border-2 border-gray-400 dark:border-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold text-gray-700 dark:text-gray-300 transition-colors flex items-center gap-2 text-sm\"\r\n                    >\r\n                      <FiPrinter className=\"text-base\" />\r\n                      Print\r\n                    </button>\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setShowCreateModal(false);\r\n                        setPrescriptionForm({ patientEmail: '', diagnosis: '', medicines: '', tests: '', rules: '', instructions: '', advice: '', followUp: '' });\r\n                        setProblem('');\r\n                        setSuggestions(null);\r\n                        setEditingTemplate(null);\r\n                        setTemplateName('');\r\n                      }}\r\n                      className=\"px-5 py-2.5 border-2 border-gray-400 dark:border-gray-500 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold text-gray-700 dark:text-gray-300 transition-colors flex items-center gap-2 text-sm ml-auto\"\r\n                    >\r\n                      <FiX className=\"text-base\" />\r\n                      Cancel\r\n                    </button>\r\n                  </div>\r\n                </form>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Preview Modal */}\r\n        {showPreviewModal && (\r\n          <div\r\n            className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto\"\r\n            onClick={(e) => {\r\n              if (e.target === e.currentTarget) {\r\n                setShowPreviewModal(false);\r\n              }\r\n            }}\r\n          >\r\n            <div className=\"bg-white dark:bg-gray-800 shadow-2xl w-full max-w-4xl my-auto rounded-lg overflow-hidden\" style={{ maxHeight: '90vh' }}>\r\n              <div className=\"p-6 border-b-2 border-gray-400 dark:border-gray-500 bg-white dark:bg-gray-800 shrink-0\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-100\">Prescription Preview</h2>\r\n                  <button\r\n                    onClick={() => setShowPreviewModal(false)}\r\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\r\n                  >\r\n                    <FiX className=\"text-2xl\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"overflow-y-auto p-6 bg-white dark:bg-gray-800\" style={{ maxHeight: 'calc(90vh - 100px)' }}>\r\n                <div className=\"prescription-preview\">\r\n                  <div className=\"border-b-3 border-black pb-4 mb-4\">\r\n                    <div className=\"flex justify-between items-start mb-3\">\r\n                      {/* Doctor Info - Left */}\r\n                      <div className=\"flex-1\">\r\n                        <div className=\"text-2xl font-bold text-teal-600 mb-2\">\r\n                          {(() => {\r\n                            const name = doctorProfile?.user?.name || user?.name || 'Name';\r\n                            const cleanName = name.replace(/^dr\\.?\\s*/i, '');\r\n                            return `Dr. ${cleanName}`;\r\n                          })()}\r\n                        </div>\r\n                        {doctorProfile?.qualification && (\r\n                          <div className=\"text-sm text-gray-700 dark:text-gray-300 mb-1\">{doctorProfile.qualification}</div>\r\n                        )}\r\n                        {doctorProfile?.specialization && (\r\n                          <div className=\"text-sm text-gray-700 dark:text-gray-300 mb-1\">{doctorProfile.specialization}</div>\r\n                        )}\r\n                        {doctorProfile?.department?.name && (\r\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">{doctorProfile.department.name}</div>\r\n                        )}\r\n                        {Array.isArray(doctorProfile?.previousJobs) && doctorProfile.previousJobs.length > 0 && (\r\n                          <div className=\"text-sm text-gray-600 dark:text-gray-400 mb-1\">\r\n                            {doctorProfile.previousJobs.map((job: any) => \r\n                              typeof job === 'string' ? job : (job.title || job.position || job)\r\n                            ).join(', ')}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                      \r\n                      {/* Logo - Right */}\r\n                      <div className=\"w-48 h-auto flex items-center justify-center\">\r\n                        <img src=\"/logo.png\" alt=\"MediWise Logo\" className=\"max-w-full h-auto object-contain\" />\r\n                      </div>\r\n                    </div>\r\n                    \r\n                    {/* Patient Info and Date - Bottom Section */}\r\n                    <div className=\"border-t-2 border-black dark:border-gray-600 pt-3 mt-3 flex justify-between items-center\">\r\n                      <div className=\"flex-1 text-sm text-black dark:text-gray-300\">\r\n                        {(() => {\r\n                          const fullName = patientInfo?.name || '';\r\n                          const namePart = fullName ? `Patient: ${fullName}` : '';\r\n                          const age = patientInfo?.age ? `    Age: ${patientInfo.age}` : '';\r\n                          const weight = patientInfo?.weight ? `Weight: ${patientInfo.weight}kg` : '';\r\n                          \r\n                          return [namePart, age, weight].filter(Boolean).join(' ');\r\n                        })()}\r\n                      </div>\r\n                      <div className=\"text-sm font-semibold text-black dark:text-gray-300\">\r\n                        {(() => {\r\n                          const date = new Date();\r\n                          const day = String(date.getDate()).padStart(2, '0');\r\n                          const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n                          const month = monthNames[date.getMonth()];\r\n                          const year = date.getFullYear();\r\n                          const dateOnly = `${day} ${month}, ${year}`;\r\n                          const timeOnly = format(date, 'h:mm a');\r\n                          return `Date: ${dateOnly} Time: ${timeOnly}`;\r\n                        })()}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                  \r\n                  {/* Two Column Layout with Blue Divider */}\r\n                  <div className=\"grid grid-cols-2 gap-10 mt-4 relative\" style={{ borderLeft: '3px solid #0066cc', paddingLeft: '20px', marginLeft: '20px' }}>\r\n                    {/* Left Column */}\r\n                    <div className=\"space-y-4\">\r\n                      {prescriptionForm.diagnosis && (\r\n                        <div>\r\n                          <div className=\"font-bold text-base border-b-2 border-gray-400 dark:border-gray-500 pb-1 mb-2 uppercase\">Diagnosis</div>\r\n                          <div className=\"text-sm whitespace-pre-wrap pl-2\">{prescriptionForm.diagnosis}</div>\r\n                        </div>\r\n                      )}\r\n                      {prescriptionForm.tests && (\r\n                        <div>\r\n                          <div className=\"font-bold text-base border-b-2 border-gray-400 dark:border-gray-500 pb-1 mb-2 uppercase\">Investigation</div>\r\n                          <div className=\"text-sm whitespace-pre-wrap pl-2\">{prescriptionForm.tests}</div>\r\n                        </div>\r\n                      )}\r\n                      {(prescriptionForm.followUp || prescriptionForm.instructions) && (\r\n                        <div>\r\n                          <div className=\"font-bold text-base border-b-2 border-gray-400 dark:border-gray-500 pb-1 mb-2 uppercase\">Follow Up</div>\r\n                          <div className=\"text-sm whitespace-pre-wrap pl-2\">{prescriptionForm.followUp || prescriptionForm.instructions}</div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                    \r\n                    {/* Right Column */}\r\n                    <div className=\"space-y-4\">\r\n                      {prescriptionForm.medicines && (\r\n                        <div>\r\n                          <div className=\"font-bold text-base border-b-2 border-gray-400 dark:border-gray-500 pb-1 mb-2 uppercase\">Medicine</div>\r\n                          <div className=\"text-sm font-mono whitespace-pre-wrap pl-2\">{prescriptionForm.medicines}</div>\r\n                        </div>\r\n                      )}\r\n                      {(prescriptionForm.advice || prescriptionForm.rules) && (\r\n                        <div>\r\n                          <div className=\"font-bold text-base border-b-2 border-gray-400 dark:border-gray-500 pb-1 mb-2 uppercase\">Advice</div>\r\n                          <div className=\"text-sm whitespace-pre-wrap pl-2\">{prescriptionForm.advice || prescriptionForm.rules}</div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                  {/* Footer with Company Information */}\r\n                  <div className=\"mt-8 border-t-2 border-gray-400 dark:border-gray-500 pt-4 text-center\">\r\n                    <div className=\"text-center\">\r\n                      <div className=\"font-bold text-lg text-teal-600 mb-2\">MediWise</div>\r\n                      <div className=\"text-sm text-gray-700 dark:text-gray-300 mb-1 flex justify-center items-center gap-1 flex-wrap\" style={{ fontFamily: 'Noto Sans Bengali, Kalpurush, Siyam Rupali, sans-serif' }}>\r\n                        <span>‡¶ö‡ßá‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞: ‡¶Æ‡ßá‡¶°‡¶ø‡¶ì‡¶Ø‡¶º‡¶æ‡¶á‡¶ú ‡¶ï‡¶®‡¶∏‡¶æ‡¶≤‡¶ü‡ßá‡¶∂‡¶® ‡¶∏‡ßá‡¶®‡ßç‡¶ü‡¶æ‡¶∞</span>\r\n                        <span>/</span>\r\n                        <span>Chamber: MediWise Consultation Center</span>\r\n                      </div>\r\n                      <div className=\"text-sm font-semibold text-teal-600 mt-2 flex justify-center items-center gap-1 flex-wrap\" style={{ fontFamily: 'Noto Sans Bengali, Kalpurush, Siyam Rupali, sans-serif' }}>\r\n                        <span>‡¶∏‡¶ø‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶π‡¶ü‡¶≤‡¶æ‡¶á‡¶®</span>\r\n                        <span>/</span>\r\n                        <span>Hotline for Serial: <strong>+8809658303665</strong></span>\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <div className=\"p-4 border-t-2 border-gray-400 dark:border-gray-500 bg-gray-50 dark:bg-gray-900 flex justify-end gap-2\">\r\n                <button\r\n                  onClick={handlePrint}\r\n                  className=\"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-semibold flex items-center gap-2\"\r\n                >\r\n                  <FiPrinter />\r\n                  Print\r\n                </button>\r\n                <button\r\n                  onClick={() => setShowPreviewModal(false)}\r\n                  className=\"px-4 py-2 border-2 border-gray-400 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold\"\r\n                >\r\n                  Close\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Template Modal */}\r\n        {showTemplateModal && (\r\n          <div\r\n            className=\"fixed inset-0 bg-black bg-opacity-60 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto\"\r\n            onClick={(e) => {\r\n              if (e.target === e.currentTarget) {\r\n                setShowTemplateModal(false);\r\n                setTemplateName('');\r\n                setEditingTemplate(null);\r\n              }\r\n            }}\r\n          >\r\n            <div className=\"bg-white dark:bg-gray-800 shadow-2xl w-full max-w-4xl my-auto rounded-lg overflow-hidden\" style={{ maxHeight: '90vh' }}>\r\n              <div className=\"p-6 border-b-2 border-gray-400 dark:border-gray-500 bg-white dark:bg-gray-800 shrink-0\">\r\n                <div className=\"flex justify-between items-center\">\r\n                  <h2 className=\"text-2xl font-bold text-gray-800 dark:text-gray-100\">\r\n                    {editingTemplate ? 'Edit Template' : 'Save as Template'}\r\n                  </h2>\r\n                  <button\r\n                    onClick={() => {\r\n                      setShowTemplateModal(false);\r\n                      setTemplateName('');\r\n                      setEditingTemplate(null);\r\n                    }}\r\n                    className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\r\n                  >\r\n                    <FiX className=\"text-2xl\" />\r\n                  </button>\r\n                </div>\r\n              </div>\r\n              <div className=\"overflow-y-auto p-6 bg-white dark:bg-gray-800\" style={{ maxHeight: 'calc(90vh - 200px)' }}>\r\n                <div className=\"mb-4\">\r\n                  <label className=\"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2\">\r\n                    Template Name <span className=\"text-red-500\">*</span>\r\n                  </label>\r\n                  <input\r\n                    type=\"text\"\r\n                    value={templateName}\r\n                    onChange={(e) => setTemplateName(e.target.value)}\r\n                    className=\"w-full px-3 py-2 border-2 border-gray-400 dark:border-gray-500 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-teal-500 bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100\"\r\n                    placeholder=\"Enter template name (e.g., Common Cold, Fever, etc.)\"\r\n                  />\r\n                </div>\r\n                <div className=\"mb-4\">\r\n                  <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">\r\n                    This will save the current prescription form as a reusable template.\r\n                  </p>\r\n                </div>\r\n                {templates.length > 0 && (\r\n                  <div className=\"mt-6\">\r\n                    <h3 className=\"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3\">Your Templates</h3>\r\n                    <div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n                      {templates.map((template) => (\r\n                        <div\r\n                          key={template.id}\r\n                          className=\"flex items-center justify-between p-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700\"\r\n                        >\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-semibold text-gray-800 dark:text-gray-100\">{template.name}</div>\r\n                            <div className=\"text-xs text-gray-500 dark:text-gray-400\">\r\n                              {format(parseISO(template.updatedAt), 'MMM dd, yyyy')}\r\n                            </div>\r\n                          </div>\r\n                          <div className=\"flex gap-2\">\r\n                            <button\r\n                              onClick={() => handleLoadTemplate(template)}\r\n                              className=\"px-3 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600\"\r\n                            >\r\n                              Load\r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleEditTemplate(template)}\r\n                              className=\"px-3 py-1 text-sm bg-green-500 text-white rounded hover:bg-green-600\"\r\n                            >\r\n                              Edit\r\n                            </button>\r\n                            <button\r\n                              onClick={() => handleDeleteTemplate(template.id)}\r\n                              className=\"px-3 py-1 text-sm bg-red-500 text-white rounded hover:bg-red-600\"\r\n                            >\r\n                              Delete\r\n                            </button>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  </div>\r\n                )}\r\n              </div>\r\n              <div className=\"p-4 border-t-2 border-gray-400 dark:border-gray-500 bg-gray-50 dark:bg-gray-900 flex justify-end gap-2\">\r\n                <button\r\n                  onClick={() => {\r\n                    setShowTemplateModal(false);\r\n                    setTemplateName('');\r\n                    setEditingTemplate(null);\r\n                  }}\r\n                  className=\"px-4 py-2 border-2 border-gray-400 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold\"\r\n                >\r\n                  Cancel\r\n                </button>\r\n                <button\r\n                  onClick={handleSaveTemplate}\r\n                  className=\"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-semibold flex items-center gap-2\"\r\n                >\r\n                  <FiSave />\r\n                  {editingTemplate ? 'Update Template' : 'Save Template'}\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        )}\r\n      </main>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}