module.exports=[93802,a=>{"use strict";var b=a.i(37037),c=a.i(4839),d=a.i(99752),e=a.i(25941),f=a.i(66733),g=a.i(33078),h=a.i(13247),i=a.i(97005),j=a.i(35557),k=a.i(8315);function l(){let{user:a,loading:l,logout:m}=(0,d.useAuth)(),{showNotification:n}=(0,e.useNotification)(),o=(0,f.useRouter)(),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)({}),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(null),[B,C]=(0,c.useState)(null);(0,c.useEffect)(()=>{l||a&&"patient"===a.role?a&&"patient"===a.role&&D():o.push("/login")},[a,l,o]);let D=async()=>{try{s(!0);let b=a?.id;if(!b){console.error("User not logged in"),s(!1);return}let c=(await i.default.get("/users/me/profile")).data.user;if(!c){console.error("User profile not found"),s(!1);return}let d={years:0,months:0};if(c.dateOfBirth){let a=new Date(c.dateOfBirth),b=new Date,e=b.getFullYear()-a.getFullYear(),f=b.getMonth()-a.getMonth();f<0&&(e--,f+=12),b.getDate()<a.getDate()&&--f<0&&(e--,f+=11),d={years:e,months:f}}let e=(await i.default.get("/prescriptions?limit=100")).data.prescriptions||[],f=e=e.filter(a=>a.patient?.email===c.email||a.patientId===b),g=f.flatMap(a=>a.medicines||[]).filter((a,b,c)=>{let d="string"==typeof a?a:a.name||"";return c.findIndex(a=>("string"==typeof a?a:a.name||"")===d)===b}).map(a=>"string"==typeof a?{name:a,brand:""}:{name:a.name||a,brand:a.dosage||a.frequency||""});(await i.default.get(`/appointments?patientId=${b}&limit=100`)).data.appointments;let h=f.filter(a=>a.instructions||a.diagnosis).map(a=>({date:a.prescriptionDate||a.createdAt,content:a.instructions||a.diagnosis||""})).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime()),j=c?.profileImage?`data:${c.profileImageMimeType||"image/jpeg"};base64,${c.profileImage}`:null;q({id:c.id?.slice(0,7)||"",name:c.name||"",profileImage:j,dateOfBirth:c.dateOfBirth||null,weight:c.weight||"",height:c.height||"",age:d,address:c.address||"",mobilePhone:c.phone||"",homePhone:c.homePhone||"",workPhone:c.workPhone||"",email:c.email||"",allergies:Array.isArray(c.allergies)?c.allergies:[],medications:g,vitals:{bloodPressure:c.bloodPressure||"",pulse:c.pulse||""},notes:h,labResults:f.filter(a=>a.tests&&a.tests.length>0).flatMap(a=>(a.tests||[]).map(b=>({name:"string"==typeof b?b:b.name||b,date:a.prescriptionDate||a.createdAt}))).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime())}),w({name:c.name||"",phone:c.phone||"",address:c.address||"",dateOfBirth:c.dateOfBirth?new Date(c.dateOfBirth).toISOString().split("T")[0]:"",weight:c.weight||"",height:c.height||"",homePhone:c.homePhone||"",workPhone:c.workPhone||"",allergies:Array.isArray(c.allergies)?c.allergies:[],bloodPressure:c.bloodPressure||"",pulse:c.pulse||""}),C(j)}catch(a){console.error("Error fetching patient data:",a),(a.response?.status===401||a.response?.status===403)&&o.push("/login")}finally{s(!1)}},E=a=>a?.split(" ")?.map(a=>a[0])?.join("")?.toUpperCase()?.slice(0,2)||"U",F=a=>{try{if(!a)return"N/A";let b=new Date(a);return(0,j.format)(b,"MM/dd/yyyy")}catch{return a}},G=async()=>{try{y(!0);let a=new FormData;a.append("name",v.name||""),a.append("phone",v.phone||""),a.append("address",v.address||""),v.dateOfBirth&&a.append("dateOfBirth",new Date(v.dateOfBirth).toISOString()),a.append("weight",v.weight||""),a.append("height",v.height||""),a.append("homePhone",v.homePhone||""),a.append("workPhone",v.workPhone||""),a.append("allergies",JSON.stringify(Array.isArray(v.allergies)?v.allergies:v.allergies?[v.allergies]:[])),a.append("bloodPressure",v.bloodPressure||""),a.append("pulse",v.pulse||""),z&&a.append("profileImage",z),(await i.default.put("/users/me/profile",a,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(await D(),u(!1),A(null),n("Profile updated successfully!","success"))}catch(a){console.error("Error updating profile:",a),n(a.response?.data?.message||"Failed to update profile","error")}finally{y(!1)}};return l||r?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(g.default,{user:a,logout:m}),(0,b.jsx)("main",{className:"ml-64 flex-1",children:(0,b.jsx)(h.default,{})})]}):a&&"patient"===a.role?p?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(g.default,{user:a,logout:m}),(0,b.jsxs)("main",{className:"ml-64 flex-1 transition-all duration-300",children:[(0,b.jsxs)("header",{className:"bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 uppercase tracking-wide",children:"My Profile"}),!t&&(0,b.jsxs)("button",{onClick:()=>{u(!0)},className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-sm font-medium",children:[(0,b.jsx)(k.FiEdit3,{className:"text-sm"}),"Edit Profile"]}),t&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{onClick:G,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium disabled:opacity-50",children:[(0,b.jsx)(k.FiSave,{className:"text-sm"}),x?"Saving...":"Save Changes"]}),(0,b.jsxs)("button",{onClick:()=>{u(!1),w({name:p?.name||"",phone:p?.mobilePhone||"",address:p?.address||"",dateOfBirth:p?.dateOfBirth?(a=>{try{if(!a)return"";let b=new Date(a);return(0,j.format)(b,"yyyy-MM-dd")}catch{return""}})(p.dateOfBirth):"",weight:p?.weight||"",height:p?.height||"",homePhone:p?.homePhone||"",workPhone:p?.workPhone||"",allergies:p?.allergies||[],bloodPressure:p?.vitals?.bloodPressure||"",pulse:p?.vitals?.pulse||""}),A(null),C(p?.profileImage||null)},disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium disabled:opacity-50",children:[(0,b.jsx)(k.FiX,{className:"text-sm"}),"Cancel"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(k.FiSearch,{className:"text-xl text-gray-600"})}),(0,b.jsx)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(k.FiMessageCircle,{className:"text-xl text-gray-600"})}),(0,b.jsx)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(k.FiBell,{className:"text-xl text-gray-600"})}),(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white font-bold",children:E(a?.name||"P")})]})]}),(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:(0,b.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[(0,b.jsxs)("div",{className:"relative mb-4",children:[(0,b.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white text-3xl font-bold overflow-hidden",children:B?(0,b.jsx)("img",{src:B,alt:p?.name,className:"w-full h-full rounded-full object-cover"}):p?.profileImage?(0,b.jsx)("img",{src:p.profileImage,alt:p.name,className:"w-full h-full rounded-full object-cover"}):E(p?.name||"P")}),t&&(0,b.jsxs)("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 flex gap-2",children:[(0,b.jsxs)("label",{className:"cursor-pointer bg-teal-600 text-white p-2 rounded-full hover:bg-teal-700 transition-colors shadow-lg",children:[(0,b.jsx)(k.FiEdit3,{className:"text-sm"}),(0,b.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>2097152)return void n("Image size must be less than 2MB","error");A(b);let a=new FileReader;a.onloadend=()=>{C(a.result)},a.readAsDataURL(b)}},className:"hidden"})]}),(B||p?.profileImage)&&(0,b.jsx)("button",{type:"button",onClick:()=>{A(null),C(null)},className:"bg-red-600 text-white p-2 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:(0,b.jsx)(k.FiX,{className:"text-sm"})})]})]}),t?(0,b.jsx)("input",{type:"text",value:v.name||"",onChange:a=>w({...v,name:a.target.value}),className:"text-2xl font-bold text-gray-800 mb-2 text-center border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent w-full"}):(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:p?.name}),!t&&p?.allergies&&p.allergies.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 justify-center mb-4",children:p.allergies.map((a,c)=>(0,b.jsx)("span",{className:"inline-block px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium",children:a},c))}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full text-left",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"DOB"}),t?(0,b.jsx)("input",{type:"date",value:v.dateOfBirth||"",onChange:a=>w({...v,dateOfBirth:a.target.value}),className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:p?.dateOfBirth?F(p.dateOfBirth):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Weight"}),t?(0,b.jsx)("input",{type:"text",value:v.weight||"",onChange:a=>w({...v,weight:a.target.value}),placeholder:"e.g., 150 lb",className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-800",children:[p?.weight||"N/A"," ",p?.weight?"lb":""]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Age"}),(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-800",children:[p?.age?.years||0,"y ",p?.age?.months||0,"m"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Height"}),t?(0,b.jsx)("input",{type:"text",value:v.height||"",onChange:a=>w({...v,height:a.target.value}),placeholder:"e.g., 5'8\"",className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:p?.height||"N/A"})]})]})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Current medications"})}),(0,b.jsx)("div",{className:"space-y-3",children:p.medications&&p.medications.length>0?p.medications.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,b.jsx)(k.FiPackage,{className:"text-teal-600"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:a.name}),a.brand&&(0,b.jsx)("p",{className:"text-xs text-gray-600",children:a.brand})]})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No medications found"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Contact Information"}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Home Address"}),t?(0,b.jsx)("textarea",{value:v.address||"",onChange:a=>w({...v,address:a.target.value}),placeholder:"Enter your address",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent",rows:2}):(0,b.jsx)("p",{className:"text-gray-800",children:p.address||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Mobile Phone #"}),t?(0,b.jsx)("input",{type:"tel",value:v.phone||"",onChange:a=>w({...v,phone:a.target.value}),placeholder:"Enter mobile phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:p.mobilePhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Home Phone #"}),t?(0,b.jsx)("input",{type:"tel",value:v.homePhone||"",onChange:a=>w({...v,homePhone:a.target.value}),placeholder:"Enter home phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:p.homePhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Work Phone #"}),t?(0,b.jsx)("input",{type:"tel",value:v.workPhone||"",onChange:a=>w({...v,workPhone:a.target.value}),placeholder:"Enter work phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:p.workPhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Email"}),(0,b.jsx)("p",{className:"text-gray-800",children:p.email})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Vitals"})}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:(0,b.jsx)(k.FiHeart,{className:"text-red-600 text-xl"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Blood Pressure"}),t?(0,b.jsx)("input",{type:"text",value:v.bloodPressure||"",onChange:a=>w({...v,bloodPressure:a.target.value}),placeholder:"e.g., 120/80",className:"w-full text-lg font-bold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-lg font-bold text-gray-800",children:p.vitals?.bloodPressure||"N/A"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:(0,b.jsx)(k.FiActivity,{className:"text-blue-600 text-xl"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Pulse"}),t?(0,b.jsx)("input",{type:"text",value:v.pulse||"",onChange:a=>w({...v,pulse:a.target.value}),placeholder:"e.g., 72 bpm",className:"w-full text-lg font-bold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-lg font-bold text-gray-800",children:p.vitals?.pulse||"N/A"})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Notes"})}),(0,b.jsx)("div",{className:"space-y-3",children:p.notes&&p.notes.length>0?p.notes.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:F(a.date)}),(0,b.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:a.content})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No notes found"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Lab results"})}),(0,b.jsx)("div",{className:"space-y-3",children:p.labResults&&p.labResults.length>0?p.labResults.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(k.FiFileText,{className:"text-teal-600"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:F(a.date)})]})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No lab results found"})})]})]})})]})]}):(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(g.default,{user:a,logout:m}),(0,b.jsx)("main",{className:"ml-64 flex-1 p-8",children:(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-500 text-lg",children:"No profile data available. Please refresh the page."})})})]}):null}a.s(["default",()=>l])}];

//# sourceMappingURL=OneDrive_Desktop_mediwise_frontend_app_patient_profile_page_tsx_368a2b1c._.js.map