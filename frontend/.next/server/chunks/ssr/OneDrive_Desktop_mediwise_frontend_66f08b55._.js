module.exports=[77402,(a,b,c)=>{"use strict";b.exports=a.r(15178).vendored["react-ssr"].ReactServerDOMTurbopackClient},13247,a=>{"use strict";var b=a.i(37037);a.s(["default",0,()=>(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-600"})})])},22227,a=>{"use strict";var b=a.i(21580),c=a.i(37530),d=a.i(36233),e=a.i(84262),f=a.i(64551),g=a.i(25778);function h(a,b){let c=(0,g.toDate)(a)-(0,g.toDate)(b);return c<0?-1:c>0?1:c}var i=a.i(58101);function j(a,j){return function(a,b,j){var k;let l,m=(0,d.getDefaultOptions)(),n=j?.locale??m.locale??c.defaultLocale,o=h(a,b);if(isNaN(o))throw RangeError("Invalid time value");let p=Object.assign({},j,{addSuffix:j?.addSuffix,comparison:o}),[q,r]=(0,f.normalizeDates)(j?.in,...o>0?[b,a]:[a,b]),s=(k=void 0,a=>{let b=(k?Math[k]:Math.trunc)(a);return 0===b?0:b})(((0,g.toDate)(r)-(0,g.toDate)(q))/1e3),t=Math.round((s-((0,e.getTimezoneOffsetInMilliseconds)(r)-(0,e.getTimezoneOffsetInMilliseconds)(q))/1e3)/60);if(t<2)if(j?.includeSeconds)if(s<5)return n.formatDistance("lessThanXSeconds",5,p);else if(s<10)return n.formatDistance("lessThanXSeconds",10,p);else if(s<20)return n.formatDistance("lessThanXSeconds",20,p);else if(s<40)return n.formatDistance("halfAMinute",0,p);else if(s<60)return n.formatDistance("lessThanXMinutes",1,p);else return n.formatDistance("xMinutes",1,p);else if(0===t)return n.formatDistance("lessThanXMinutes",1,p);else return n.formatDistance("xMinutes",t,p);if(t<45)return n.formatDistance("xMinutes",t,p);if(t<90)return n.formatDistance("aboutXHours",1,p);if(t<i.minutesInDay){let a=Math.round(t/60);return n.formatDistance("aboutXHours",a,p)}if(t<2520)return n.formatDistance("xDays",1,p);else if(t<i.minutesInMonth){let a=Math.round(t/i.minutesInDay);return n.formatDistance("xDays",a,p)}else if(t<2*i.minutesInMonth)return l=Math.round(t/i.minutesInMonth),n.formatDistance("aboutXMonths",l,p);if((l=function(a,b,c){var d,e;let i,j,k,l,[m,n,o]=(0,f.normalizeDates)(void 0,a,a,b),p=h(n,o),q=Math.abs(function(a,b,c){let[d,e]=(0,f.normalizeDates)(void 0,a,b);return 12*(d.getFullYear()-e.getFullYear())+(d.getMonth()-e.getMonth())}(n,o));if(q<1)return 0;1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-p*q);let r=h(n,o)===-p;+(i=(0,g.toDate)(m,void 0),d=void 0,(j=(0,g.toDate)(i,d?.in)).setHours(23,59,59,999),j)==+(e=void 0,l=(k=(0,g.toDate)(i,e?.in)).getMonth(),k.setFullYear(k.getFullYear(),l+1,0),k.setHours(23,59,59,999),k)&&1===q&&1===h(m,o)&&(r=!1);let s=p*(q-r);return 0===s?0:s}(r,q))<12){let a=Math.round(t/i.minutesInMonth);return n.formatDistance("xMonths",a,p)}{let a=l%12,b=Math.trunc(l/12);return a<3?n.formatDistance("aboutXYears",b,p):a<9?n.formatDistance("overXYears",b,p):n.formatDistance("almostXYears",b+1,p)}}(a,(0,b.constructFrom)(a,Date.now()),j)}a.s(["formatDistanceToNow",()=>j],22227)},9803,a=>{"use strict";var b=a.i(37037),c=a.i(4839),d=a.i(99752),e=a.i(25941),f=a.i(66733),g=a.i(5711),h=a.i(42006),i=a.i(13247),j=a.i(97005),k=a.i(35557),l=a.i(22227),m=a.i(8315);function n(){let{user:a,loading:n,logout:o}=(0,d.useAuth)(),{showNotification:p}=(0,e.useNotification)(),q=(0,f.useRouter)(),[r,s]=(0,c.useState)([]),[t,u]=(0,c.useState)([]),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)(!0),[D,E]=(0,c.useState)(0),[F,G]=(0,c.useState)(""),[H,I]=(0,c.useState)(!1),J=(0,c.useRef)(null),K=(0,c.useRef)(null);(0,c.useEffect)(()=>{n||a?a&&"admin"!==a.role?"patient"===a.role?q.push("/patient/dashboard"):"doctor"===a.role?q.push("/doctor/dashboard"):q.push("/dashboard"):a&&"admin"===a.role&&(L(),M(),O()):q.push("/login")},[a,n,q]),(0,c.useEffect)(()=>{if(a&&"admin"===a.role){let a=setInterval(()=>{L(),M(),v&&N(v.id),O()},2e3);return()=>clearInterval(a)}},[a,v]),(0,c.useEffect)(()=>(v&&(K.current&&clearInterval(K.current),K.current=setInterval(()=>{N(v.id),M(),O()},2e3)),()=>{K.current&&clearInterval(K.current)}),[v]),(0,c.useEffect)(()=>{J.current?.scrollIntoView({behavior:"smooth"})},[x]);let L=async()=>{try{let a=await j.default.get("/chat/users");s(a.data.users||[])}catch(a){console.error("Error fetching chat users:",a)}},M=async()=>{try{let a=await j.default.get("/chat/conversations");u(a.data.conversations||[])}catch(a){console.error("Error fetching conversations:",a)}},N=async a=>{try{let b=await j.default.get(`/chat/messages/${a}`);y(b.data.messages||[])}catch(a){console.error("Error fetching messages:",a)}},O=async()=>{try{let a=await j.default.get("/chat/unread-count");E(a.data.unreadCount||0)}catch(a){console.error("Error fetching unread count:",a)}finally{C(!1)}},P=a=>{let b=t.find(b=>b.id===a.id);if(b)w(b),N(b.id),G(""),I(!1);else w({id:a.id,name:a.name,email:a.email,role:a.role,phone:a.phone,lastMessage:a.lastMessage||"No messages yet",lastMessageTime:a.lastMessageTime||new Date,unreadCount:a.unreadCount||0}),y([]);G(""),I(!1)},Q=r.filter(a=>{let b=F.toLowerCase();return a.name.toLowerCase().includes(b)||a.email.toLowerCase().includes(b)||a.id.toLowerCase().includes(b)||a.phone&&a.phone.includes(b)||a.role.toLowerCase().includes(b)}),R=async a=>{if(a.preventDefault(),z.trim()&&v)try{await j.default.post("/chat/send",{receiverId:v.id,content:z.trim()}),A(""),setTimeout(()=>{N(v.id),M(),L(),O()},100)}catch(a){console.error("Error sending message:",a),p(a.response?.data?.message||"Failed to send message","error")}},S=a=>a?.split(" ")?.map(a=>a[0])?.join("")?.toUpperCase()?.slice(0,2)||"U";return n||B?(0,b.jsx)(i.default,{}):a&&"admin"===a.role?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,b.jsx)(g.default,{}),(0,b.jsxs)("main",{className:"ml-64 flex-1 transition-all duration-300",children:[(0,b.jsx)(h.default,{title:`Chats ${D>0?`(${D})`:""}`,searchPlaceholder:"Search by ID, name, email...",onSearch:a=>{G(a),I(a.length>0)}}),(0,b.jsx)("div",{className:"p-8",children:(0,b.jsx)("div",{className:"flex flex-col h-[calc(100vh-200px)] bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden transition-colors",children:(0,b.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,b.jsxs)("div",{className:"w-1/3 border-r border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 flex flex-col transition-colors",children:[(0,b.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold text-gray-800 dark:text-gray-100 mb-3",children:["All Users ",D>0&&`(${D})`]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(m.FiSearch,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,b.jsx)("input",{type:"text",value:F,onChange:a=>{G(a.target.value),I(a.target.value.length>0)},onFocus:()=>{F.length>0&&I(!0)},onBlur:()=>{setTimeout(()=>I(!1),200)},placeholder:"Search by ID, name, email...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors"}),H&&Q.length>0&&(0,b.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto transition-colors",children:Q.slice(0,5).map(a=>(0,b.jsx)("div",{onMouseDown:b=>{b.preventDefault(),P(a)},className:"px-4 py-3 hover:bg-teal-50 dark:hover:bg-gray-700 cursor-pointer border-b border-gray-100 dark:border-gray-700 last:border-0 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white font-bold text-sm",children:S(a.name)}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"font-semibold text-gray-800 dark:text-gray-100",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 capitalize",children:a.role}),(0,b.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500 mt-1",children:["ID: ",a.id.slice(0,8),"..."]})]}),a.unreadCount>0&&(0,b.jsx)("span",{className:"bg-blue-600 text-white text-xs px-2 py-1 rounded-full",children:a.unreadCount})]})},a.id))})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===r.length?(0,b.jsx)("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400",children:(0,b.jsx)("p",{children:"No users available"})}):Q.map(a=>{let c=t.find(b=>b.id===a.id),d=v?.id===a.id,e=c||a;return(0,b.jsx)("div",{onClick:()=>P(a),className:`p-4 border-b border-gray-100 dark:border-gray-700 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors ${d?"bg-teal-50 dark:bg-gray-700 border-l-4 border-teal-600":""}`,children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white font-bold",children:S(a.name)}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-gray-100 truncate",children:a.name}),e.lastMessageTime&&(0,b.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:(0,l.formatDistanceToNow)(new Date(e.lastMessageTime),{addSuffix:!0})})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate mt-1",children:e.lastMessage||"No messages yet"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:["ID: ",a.id.slice(0,8),"..."]}),(0,b.jsx)("span",{className:"text-xs text-gray-400",children:"â€¢"}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:a.role})]})]}),a.unreadCount>0&&(0,b.jsx)("span",{className:"bg-teal-600 text-white text-xs px-2 py-1 rounded-full",children:a.unreadCount})]})},a.id)})})]}),(0,b.jsx)("div",{className:"flex-1 flex flex-col bg-gray-50 dark:bg-gray-900 transition-colors",children:v?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 flex items-center justify-between transition-colors",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white font-bold",children:S(v.name)}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-gray-100",children:v.name}),(0,b.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:v.role}),(0,b.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:["ID: ",v.id.slice(0,8),"..."]})]})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[x.map(c=>{let d=c.senderId===a?.id;return(0,b.jsx)("div",{className:`flex ${d?"justify-end":"justify-start"}`,children:(0,b.jsxs)("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${d?"bg-teal-600 text-white":"bg-white dark:bg-gray-700 text-gray-800 dark:text-gray-100 border border-gray-200 dark:border-gray-600"} transition-colors`,children:[!d&&(0,b.jsx)("p",{className:"text-xs font-semibold mb-1 opacity-75",children:c.sender.name}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:c.content}),(0,b.jsxs)("div",{className:`flex items-center gap-1 mt-1 ${d?"justify-end":"justify-start"}`,children:[(0,b.jsx)("p",{className:`text-xs ${d?"text-blue-100":"text-gray-500 dark:text-gray-400"}`,children:(0,k.format)(new Date(c.createdAt),"h:mm a")}),d&&(0,b.jsx)("div",{className:"flex items-center",children:c.isRead?(0,b.jsxs)("span",{className:"text-blue-300 text-xs ml-1 flex items-center gap-0.5",children:[(0,b.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,b.jsx)("span",{className:"text-[10px]",children:"Seen"})]}):(0,b.jsx)("span",{className:"text-gray-300 text-xs ml-1",children:(0,b.jsx)("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:(0,b.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})})]})]})},c.id)}),(0,b.jsx)("div",{ref:J})]}),(0,b.jsx)("div",{className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-4 transition-colors",children:(0,b.jsxs)("form",{onSubmit:R,className:"flex items-center gap-2",children:[(0,b.jsx)("button",{type:"button",className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,b.jsx)(m.FiPaperclip,{className:"text-xl text-gray-600 dark:text-gray-300"})}),(0,b.jsx)("input",{type:"text",value:z,onChange:a=>A(a.target.value),placeholder:"Type a message...",className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-full focus:ring-2 focus:ring-teal-500 focus:border-transparent bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100 transition-colors"}),(0,b.jsx)("button",{type:"submit",disabled:!z.trim(),className:"p-2 bg-teal-600 text-white rounded-full hover:bg-teal-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:(0,b.jsx)(m.FiSend,{className:"text-xl"})})]})})]}):(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(m.FiMessageCircle,{className:"text-6xl text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-lg",children:"Select a user to start chatting"}),(0,b.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-2",children:"Search by ID, name, email, or phone"})]})})})]})})})]})]}):null}a.s(["default",()=>n])}];

//# sourceMappingURL=OneDrive_Desktop_mediwise_frontend_66f08b55._.js.map