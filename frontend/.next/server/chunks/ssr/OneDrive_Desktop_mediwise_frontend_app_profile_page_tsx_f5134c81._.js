module.exports=[89297,a=>{"use strict";var b=a.i(37037),c=a.i(4839),d=a.i(99752),e=a.i(25941),f=a.i(66733),g=a.i(68426),h=a.i(13247),i=a.i(33078),j=a.i(97005),k=a.i(35557),l=a.i(8315);function m(){let{user:a,loading:m,logout:n}=(0,d.useAuth)(),{showNotification:o}=(0,e.useNotification)(),p=(0,f.useRouter)(),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null);(0,c.useEffect)(()=>{m||a&&"patient"===a.role||p.push("/login")},[a,m,p]),(0,c.useEffect)(()=>{a&&"patient"===a.role&&E()},[a]);let E=async()=>{try{t(!0);let a=(await j.default.get("/users/me/profile")).data.user,b={years:0,months:0};if(a?.dateOfBirth){let c=new Date(a.dateOfBirth),d=new Date,e=d.getFullYear()-c.getFullYear(),f=d.getMonth()-c.getMonth();f<0&&(e--,f+=12),d.getDate()<c.getDate()&&--f<0&&(e--,f+=11),b={years:e,months:f}}let c=(await j.default.get("/prescriptions?limit=100")).data.prescriptions||[],d=c.flatMap(a=>a.medicines||[]).filter((a,b,c)=>{let d="string"==typeof a?a:a.name||"";return c.findIndex(a=>("string"==typeof a?a:a.name||"")===d)===b}).map(a=>"string"==typeof a?{name:a,brand:""}:{name:a.name||a,brand:a.dosage||a.frequency||""}),e=c.filter(a=>a.instructions||a.diagnosis).map(a=>({date:a.prescriptionDate||a.createdAt,content:a.instructions||a.diagnosis||""})).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime()),f=a?.profileImage?`data:${a.profileImageMimeType||"image/jpeg"};base64,${a.profileImage}`:null,g={id:a?.id,displayId:a?.id?.slice(0,7),name:a?.name,profileImage:f,dateOfBirth:a?.dateOfBirth,weight:a?.weight||"",height:a?.height||"",age:b,address:a?.address||"",mobilePhone:a?.phone||"",homePhone:a?.homePhone||"",workPhone:a?.workPhone||"",email:a?.email,allergies:a?.allergies||[],medications:d,vitals:{bloodPressure:a?.bloodPressure||"",pulse:a?.pulse||""},notes:e,labResults:c.filter(a=>a.tests&&a.tests.length>0).flatMap(a=>(a.tests||[]).map(b=>({name:"string"==typeof b?b:b.name||b,date:a.prescriptionDate||a.createdAt}))).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime())};r(g),x(g),D(f)}catch(a){console.error("Error fetching patient data:",a),a.response?.status===401||a.response?.status===403?p.push("/login"):r(null)}finally{t(!1)}},F=a=>a?.split(" ")?.map(a=>a[0])?.join("")?.toUpperCase()?.slice(0,2)||"U",G=a=>{try{let b=new Date(a);return(0,k.format)(b,"MM/dd/yyyy")}catch{return a}},H=a=>{try{let b=new Date(a);return(0,k.format)(b,"yyyy-MM-dd")}catch{return""}},I=async()=>{try{z(!0);let a=new FormData;a.append("name",w.name||""),a.append("phone",w.mobilePhone||""),a.append("address",w.address||""),w.dateOfBirth&&a.append("dateOfBirth",new Date(w.dateOfBirth).toISOString()),a.append("weight",w.weight||""),a.append("height",w.height||""),a.append("homePhone",w.homePhone||""),a.append("workPhone",w.workPhone||""),a.append("allergies",JSON.stringify(Array.isArray(w.allergies)?w.allergies:w.allergies?[w.allergies]:[])),a.append("bloodPressure",w.vitals?.bloodPressure||""),a.append("pulse",w.vitals?.pulse||""),A&&a.append("profileImage",A),w.removeProfileImage&&a.append("removeProfileImage","true"),(await j.default.put("/users/me/profile",a,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(await E(),v(!1),B(null),x({...w,removeProfileImage:!1}),o("Profile updated successfully!","success"))}catch(a){console.error("Error updating profile:",a),o(a.response?.data?.message||"Failed to update profile","error")}finally{z(!1)}};return m||s?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{user:a,logout:n}),(0,b.jsx)("main",{className:"ml-64 flex-1",children:(0,b.jsx)(h.default,{})})]}):a&&"patient"===a.role?q?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{user:a,logout:n}),(0,b.jsxs)("main",{className:"ml-64 flex-1 transition-all duration-300",children:[(0,b.jsxs)("header",{className:"bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 uppercase tracking-wide",children:"MY PROFILE"}),!u&&(0,b.jsxs)("button",{onClick:()=>{v(!0),x({...q,dateOfBirth:q?.dateOfBirth?H(q.dateOfBirth):""})},className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-sm font-medium",children:[(0,b.jsx)(l.FiEdit3,{className:"text-sm"}),"Edit Profile"]}),u&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{onClick:I,disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium disabled:opacity-50",children:[(0,b.jsx)(l.FiSave,{className:"text-sm"}),y?"Saving...":"Save Changes"]}),(0,b.jsxs)("button",{onClick:()=>{v(!1),x(q)},disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium disabled:opacity-50",children:[(0,b.jsx)(l.FiX,{className:"text-sm"}),"Cancel"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(l.FiSearch,{className:"text-xl text-gray-600"})}),(0,b.jsxs)(g.default,{href:"/patient/chat",className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,b.jsx)(l.FiMessageCircle,{className:"text-xl text-gray-600"}),(0,b.jsx)("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"2"})]}),(0,b.jsxs)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,b.jsx)(l.FiBell,{className:"text-xl text-gray-600"}),(0,b.jsx)("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"2"})]}),(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white font-bold",children:F(a?.name||"P")})]})]}),(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:(0,b.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[(0,b.jsxs)("div",{className:"relative mb-4",children:[(0,b.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white text-3xl font-bold overflow-hidden",children:C?(0,b.jsx)("img",{src:C,alt:q?.name,className:"w-full h-full rounded-full object-cover"}):q?.profileImage?(0,b.jsx)("img",{src:q.profileImage,alt:q.name,className:"w-full h-full rounded-full object-cover"}):F(q?.name||"P")}),u&&(0,b.jsxs)("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 flex gap-2",children:[(0,b.jsxs)("label",{className:"cursor-pointer bg-teal-600 text-white p-2 rounded-full hover:bg-teal-700 transition-colors shadow-lg",children:[(0,b.jsx)(l.FiEdit3,{className:"text-sm"}),(0,b.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>2097152)return void o("Image size must be less than 2MB","warning");B(b);let a=new FileReader;a.onloadend=()=>{D(a.result)},a.readAsDataURL(b)}},className:"hidden"})]}),(C||q?.profileImage)&&(0,b.jsx)("button",{type:"button",onClick:()=>{B(null),D(null),x({...w,removeProfileImage:!0})},className:"bg-red-600 text-white p-2 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:(0,b.jsx)(l.FiX,{className:"text-sm"})})]})]}),u?(0,b.jsx)("input",{type:"text",value:w.name||"",onChange:a=>x({...w,name:a.target.value}),className:"text-2xl font-bold text-gray-800 mb-2 text-center border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent w-full"}):(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:q?.name}),!u&&q?.allergies&&q.allergies.length>0&&(0,b.jsx)("div",{className:"inline-block px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium mb-4",children:"Allergy"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full text-left",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"DOB"}),u?(0,b.jsx)("input",{type:"date",value:w.dateOfBirth?H(w.dateOfBirth):"",onChange:a=>x({...w,dateOfBirth:a.target.value}),className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:q?.dateOfBirth?G(q.dateOfBirth):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Weight"}),u?(0,b.jsx)("input",{type:"text",value:w.weight||"",onChange:a=>x({...w,weight:a.target.value}),placeholder:"e.g., 150 lb",className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-800",children:[q?.weight||"N/A"," ",q?.weight?"lb":""]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Age"}),(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-800",children:[q?.age?.years||0,"y ",q?.age?.months||0,"m"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Height"}),u?(0,b.jsx)("input",{type:"text",value:w.height||"",onChange:a=>x({...w,height:a.target.value}),placeholder:"e.g., 5'8\"",className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:q?.height||"N/A"})]})]}),(0,b.jsx)(g.default,{href:"/patient/chat",className:"w-full mt-6 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-medium text-center",children:"SEND MESSAGE"})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Current medications"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiPlus,{className:"text-gray-600"})}),(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:q.medications&&q.medications.length>0?q.medications.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,b.jsx)(l.FiPackage,{className:"text-teal-600"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:a.name}),a.brand&&(0,b.jsx)("p",{className:"text-xs text-gray-600",children:a.brand})]})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No medications found"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Contact Information"}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Home Address"}),u?(0,b.jsx)("textarea",{value:w.address||"",onChange:a=>x({...w,address:a.target.value}),placeholder:"Enter your address",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent",rows:2}):(0,b.jsx)("p",{className:"text-gray-800",children:q.address||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Mobile Phone #"}),u?(0,b.jsx)("input",{type:"tel",value:w.mobilePhone||"",onChange:a=>x({...w,mobilePhone:a.target.value}),placeholder:"Enter mobile phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:q.mobilePhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Home Phone #"}),u?(0,b.jsx)("input",{type:"tel",value:w.homePhone||"",onChange:a=>x({...w,homePhone:a.target.value}),placeholder:"Enter home phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:q.homePhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Work Phone #"}),u?(0,b.jsx)("input",{type:"tel",value:w.workPhone||"",onChange:a=>x({...w,workPhone:a.target.value}),placeholder:"Enter work phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:q.workPhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Email"}),(0,b.jsx)("p",{className:"text-gray-800",children:q.email})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Vitals"}),!u&&(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:(0,b.jsx)(l.FiHeart,{className:"text-red-600 text-xl"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Blood Pressure"}),u?(0,b.jsx)("input",{type:"text",value:w.vitals?.bloodPressure||"",onChange:a=>x({...w,vitals:{...w.vitals,bloodPressure:a.target.value}}),placeholder:"e.g., 120/80",className:"w-full text-lg font-bold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-lg font-bold text-gray-800",children:q.vitals?.bloodPressure||"N/A"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:(0,b.jsx)(l.FiActivity,{className:"text-blue-600 text-xl"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Pulse"}),u?(0,b.jsx)("input",{type:"text",value:w.vitals?.pulse||"",onChange:a=>x({...w,vitals:{...w.vitals,pulse:a.target.value}}),placeholder:"e.g., 72 bpm",className:"w-full text-lg font-bold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-lg font-bold text-gray-800",children:q.vitals?.pulse||"N/A"})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Notes"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiPlus,{className:"text-gray-600"})}),(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:q.notes&&q.notes.length>0?q.notes.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:G(a.date)}),(0,b.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:a.content})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No notes found"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Lab results"}),(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]}),(0,b.jsx)("div",{className:"space-y-3",children:q.labResults&&q.labResults.length>0?q.labResults.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(l.FiFileText,{className:"text-teal-600"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:G(a.date)})]})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No lab results found"})})]})]})})]})]}):(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{user:a,logout:n}),(0,b.jsx)("main",{className:"ml-64 flex-1 p-8",children:(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-500 text-lg",children:"No profile data available. Please refresh the page."})})})]}):null}function m(){let{user:a,loading:m,logout:n}=(0,d.useAuth)(),{showNotification:o}=(0,e.useNotification)(),p=(0,f.useRouter)(),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)(!0),[u,v]=(0,c.useState)(!1),[w,x]=(0,c.useState)({}),[y,z]=(0,c.useState)(!1),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(null);(0,c.useEffect)(()=>{m||a&&"patient"===a.role||p.push("/login")},[a,m,p]),(0,c.useEffect)(()=>{a&&"patient"===a.role&&E()},[a]);let E=async()=>{try{t(!0);let a=(await j.default.get("/users/me/profile")).data.user,b={years:0,months:0};if(a?.dateOfBirth){let c=new Date(a.dateOfBirth),d=new Date,e=d.getFullYear()-c.getFullYear(),f=d.getMonth()-c.getMonth();f<0&&(e--,f+=12),d.getDate()<c.getDate()&&--f<0&&(e--,f+=11),b={years:e,months:f}}let c=(await j.default.get("/prescriptions?limit=100")).data.prescriptions||[],d=c.flatMap(a=>a.medicines||[]).filter((a,b,c)=>{let d="string"==typeof a?a:a.name||"";return c.findIndex(a=>("string"==typeof a?a:a.name||"")===d)===b}).map(a=>"string"==typeof a?{name:a,brand:""}:{name:a.name||a,brand:a.dosage||a.frequency||""}),e=c.filter(a=>a.instructions||a.diagnosis).map(a=>({date:a.prescriptionDate||a.createdAt,content:a.instructions||a.diagnosis||""})).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime()),f=a?.profileImage?`data:${a.profileImageMimeType||"image/jpeg"};base64,${a.profileImage}`:null,g={id:a?.id,displayId:a?.id?.slice(0,7),name:a?.name,profileImage:f,dateOfBirth:a?.dateOfBirth,weight:a?.weight||"",height:a?.height||"",age:b,address:a?.address||"",mobilePhone:a?.phone||"",homePhone:a?.homePhone||"",workPhone:a?.workPhone||"",email:a?.email,allergies:a?.allergies||[],medications:d,vitals:{bloodPressure:a?.bloodPressure||"",pulse:a?.pulse||""},notes:e,labResults:c.filter(a=>a.tests&&a.tests.length>0).flatMap(a=>(a.tests||[]).map(b=>({name:"string"==typeof b?b:b.name||b,date:a.prescriptionDate||a.createdAt}))).sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime())};r(g),x(g),D(f)}catch(a){console.error("Error fetching patient data:",a),a.response?.status===401||a.response?.status===403?p.push("/login"):r(null)}finally{t(!1)}},F=a=>a?.split(" ")?.map(a=>a[0])?.join("")?.toUpperCase()?.slice(0,2)||"U",G=a=>{try{let b=new Date(a);return(0,k.format)(b,"MM/dd/yyyy")}catch{return a}},H=a=>{try{let b=new Date(a);return(0,k.format)(b,"yyyy-MM-dd")}catch{return""}},I=async()=>{try{z(!0);let a=new FormData;a.append("name",w.name||""),a.append("phone",w.mobilePhone||""),a.append("address",w.address||""),w.dateOfBirth&&a.append("dateOfBirth",new Date(w.dateOfBirth).toISOString()),a.append("weight",w.weight||""),a.append("height",w.height||""),a.append("homePhone",w.homePhone||""),a.append("workPhone",w.workPhone||""),a.append("allergies",JSON.stringify(Array.isArray(w.allergies)?w.allergies:w.allergies?[w.allergies]:[])),a.append("bloodPressure",w.vitals?.bloodPressure||""),a.append("pulse",w.vitals?.pulse||""),A&&a.append("profileImage",A),w.removeProfileImage&&a.append("removeProfileImage","true"),(await j.default.put("/users/me/profile",a,{headers:{"Content-Type":"multipart/form-data"}})).data.success&&(await E(),v(!1),B(null),x({...w,removeProfileImage:!1}),o("Profile updated successfully!","success"))}catch(a){console.error("Error updating profile:",a),o(a.response?.data?.message||"Failed to update profile","error")}finally{z(!1)}};return m||s?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{user:a,logout:n}),(0,b.jsx)("main",{className:"ml-64 flex-1",children:(0,b.jsx)(h.default,{})})]}):a&&"patient"===a.role?q?(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{user:a,logout:n}),(0,b.jsxs)("main",{className:"ml-64 flex-1 transition-all duration-300",children:[(0,b.jsxs)("header",{className:"bg-white border-b border-gray-200 px-8 py-4 flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-800 uppercase tracking-wide",children:"MY PROFILE"}),!u&&(0,b.jsxs)("button",{onClick:()=>{v(!0),x({...q,dateOfBirth:q?.dateOfBirth?H(q.dateOfBirth):""})},className:"flex items-center gap-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors text-sm font-medium",children:[(0,b.jsx)(l.FiEdit3,{className:"text-sm"}),"Edit Profile"]}),u&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("button",{onClick:I,disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm font-medium disabled:opacity-50",children:[(0,b.jsx)(l.FiSave,{className:"text-sm"}),y?"Saving...":"Save Changes"]}),(0,b.jsxs)("button",{onClick:()=>{v(!1),x(q)},disabled:y,className:"flex items-center gap-2 px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium disabled:opacity-50",children:[(0,b.jsx)(l.FiX,{className:"text-sm"}),"Cancel"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:(0,b.jsx)(l.FiSearch,{className:"text-xl text-gray-600"})}),(0,b.jsxs)(g.default,{href:"/patient/chat",className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,b.jsx)(l.FiMessageCircle,{className:"text-xl text-gray-600"}),(0,b.jsx)("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"2"})]}),(0,b.jsxs)("button",{className:"relative p-2 hover:bg-gray-100 rounded-lg transition-colors",children:[(0,b.jsx)(l.FiBell,{className:"text-xl text-gray-600"}),(0,b.jsx)("span",{className:"absolute top-0 right-0 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:"2"})]}),(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white font-bold",children:F(a?.name||"P")})]})]}),(0,b.jsx)("div",{className:"p-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:(0,b.jsxs)("div",{className:"flex flex-col items-center text-center mb-6",children:[(0,b.jsxs)("div",{className:"relative mb-4",children:[(0,b.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-teal-400 to-indigo-500 flex items-center justify-center text-white text-3xl font-bold overflow-hidden",children:C?(0,b.jsx)("img",{src:C,alt:q?.name,className:"w-full h-full rounded-full object-cover"}):q?.profileImage?(0,b.jsx)("img",{src:q.profileImage,alt:q.name,className:"w-full h-full rounded-full object-cover"}):F(q?.name||"P")}),u&&(0,b.jsxs)("div",{className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 flex gap-2",children:[(0,b.jsxs)("label",{className:"cursor-pointer bg-teal-600 text-white p-2 rounded-full hover:bg-teal-700 transition-colors shadow-lg",children:[(0,b.jsx)(l.FiEdit3,{className:"text-sm"}),(0,b.jsx)("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:a=>{let b=a.target.files?.[0];if(b){if(b.size>2097152)return void o("Image size must be less than 2MB","warning");B(b);let a=new FileReader;a.onloadend=()=>{D(a.result)},a.readAsDataURL(b)}},className:"hidden"})]}),(C||q?.profileImage)&&(0,b.jsx)("button",{type:"button",onClick:()=>{B(null),D(null),x({...w,removeProfileImage:!0})},className:"bg-red-600 text-white p-2 rounded-full hover:bg-red-700 transition-colors shadow-lg",children:(0,b.jsx)(l.FiX,{className:"text-sm"})})]})]}),u?(0,b.jsx)("input",{type:"text",value:w.name||"",onChange:a=>x({...w,name:a.target.value}),className:"text-2xl font-bold text-gray-800 mb-2 text-center border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent w-full"}):(0,b.jsx)("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:q?.name}),!u&&q?.allergies&&q.allergies.length>0&&(0,b.jsx)("div",{className:"inline-block px-3 py-1 bg-red-100 text-red-700 rounded-full text-sm font-medium mb-4",children:"Allergy"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 w-full text-left",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"DOB"}),u?(0,b.jsx)("input",{type:"date",value:w.dateOfBirth?H(w.dateOfBirth):"",onChange:a=>x({...w,dateOfBirth:a.target.value}),className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:q?.dateOfBirth?G(q.dateOfBirth):"N/A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Weight"}),u?(0,b.jsx)("input",{type:"text",value:w.weight||"",onChange:a=>x({...w,weight:a.target.value}),placeholder:"e.g., 150 lb",className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-800",children:[q?.weight||"N/A"," ",q?.weight?"lb":""]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Age"}),(0,b.jsxs)("p",{className:"text-sm font-semibold text-gray-800",children:[q?.age?.years||0,"y ",q?.age?.months||0,"m"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Height"}),u?(0,b.jsx)("input",{type:"text",value:w.height||"",onChange:a=>x({...w,height:a.target.value}),placeholder:"e.g., 5'8\"",className:"w-full text-sm font-semibold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:q?.height||"N/A"})]})]}),(0,b.jsx)(g.default,{href:"/patient/chat",className:"w-full mt-6 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 transition-colors font-medium text-center",children:"SEND MESSAGE"})]})}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Current medications"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiPlus,{className:"text-gray-600"})}),(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:q.medications&&q.medications.length>0?q.medications.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,b.jsx)(l.FiPackage,{className:"text-teal-600"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800",children:a.name}),a.brand&&(0,b.jsx)("p",{className:"text-xs text-gray-600",children:a.brand})]})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No medications found"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Contact Information"}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Home Address"}),u?(0,b.jsx)("textarea",{value:w.address||"",onChange:a=>x({...w,address:a.target.value}),placeholder:"Enter your address",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent",rows:2}):(0,b.jsx)("p",{className:"text-gray-800",children:q.address||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Mobile Phone #"}),u?(0,b.jsx)("input",{type:"tel",value:w.mobilePhone||"",onChange:a=>x({...w,mobilePhone:a.target.value}),placeholder:"Enter mobile phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:q.mobilePhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Home Phone #"}),u?(0,b.jsx)("input",{type:"tel",value:w.homePhone||"",onChange:a=>x({...w,homePhone:a.target.value}),placeholder:"Enter home phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:q.homePhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Work Phone #"}),u?(0,b.jsx)("input",{type:"tel",value:w.workPhone||"",onChange:a=>x({...w,workPhone:a.target.value}),placeholder:"Enter work phone",className:"w-full text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-gray-800",children:q.workPhone||"Not provided"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Email"}),(0,b.jsx)("p",{className:"text-gray-800",children:q.email})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Vitals"}),!u&&(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:(0,b.jsx)(l.FiHeart,{className:"text-red-600 text-xl"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Blood Pressure"}),u?(0,b.jsx)("input",{type:"text",value:w.vitals?.bloodPressure||"",onChange:a=>x({...w,vitals:{...w.vitals,bloodPressure:a.target.value}}),placeholder:"e.g., 120/80",className:"w-full text-lg font-bold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-lg font-bold text-gray-800",children:q.vitals?.bloodPressure||"N/A"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:(0,b.jsx)(l.FiActivity,{className:"text-blue-600 text-xl"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 uppercase mb-1",children:"Pulse"}),u?(0,b.jsx)("input",{type:"text",value:w.vitals?.pulse||"",onChange:a=>x({...w,vitals:{...w.vitals,pulse:a.target.value}}),placeholder:"e.g., 72 bpm",className:"w-full text-lg font-bold text-gray-800 border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"}):(0,b.jsx)("p",{className:"text-lg font-bold text-gray-800",children:q.vitals?.pulse||"N/A"})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Notes"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiPlus,{className:"text-gray-600"})}),(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:q.notes&&q.notes.length>0?q.notes.map((a,c)=>(0,b.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,b.jsx)("p",{className:"text-xs text-gray-500 mb-2",children:G(a.date)}),(0,b.jsx)("p",{className:"text-sm text-gray-800 leading-relaxed",children:a.content})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No notes found"})})]}),(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6 border border-gray-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Lab results"}),(0,b.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded transition-colors",children:(0,b.jsx)(l.FiMoreVertical,{className:"text-gray-600"})})]}),(0,b.jsx)("div",{className:"space-y-3",children:q.labResults&&q.labResults.length>0?q.labResults.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-full bg-teal-100 flex items-center justify-center flex-shrink-0",children:(0,b.jsx)(l.FiFileText,{className:"text-teal-600"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-gray-800 truncate",children:a.name}),(0,b.jsx)("p",{className:"text-xs text-gray-600",children:G(a.date)})]})]},c)):(0,b.jsx)("p",{className:"text-sm text-gray-500 text-center py-4",children:"No lab results found"})})]})]})})]})]}):(0,b.jsxs)("div",{className:"flex min-h-screen bg-gray-50",children:[(0,b.jsx)(i.default,{user:a,logout:n}),(0,b.jsx)("main",{className:"ml-64 flex-1 p-8",children:(0,b.jsx)("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:(0,b.jsx)("p",{className:"text-gray-500 text-lg",children:"No profile data available. Please refresh the page."})})})]}):null}a.s(["default",()=>m])}];

//# sourceMappingURL=OneDrive_Desktop_mediwise_frontend_app_profile_page_tsx_f5134c81._.js.map